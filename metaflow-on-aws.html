<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-148913719-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Metaflow Docs" href="/opensearch.xml"><title data-react-helmet="true">Metaflow on AWS | Metaflow Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://docs.metaflow.org/img/Metaflow_Logo_Vertical_FullColor_Ribbon_Dark_RGB.png"><meta data-react-helmet="true" name="twitter:image" content="https://docs.metaflow.org/img/Metaflow_Logo_Vertical_FullColor_Ribbon_Dark_RGB.png"><meta data-react-helmet="true" property="og:url" content="https://docs.metaflow.org/metaflow-on-aws"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Metaflow on AWS | Metaflow Docs"><meta data-react-helmet="true" name="description" content="Traditionally, there has been a tension between local \(e.g. on a laptop\) and remote \(e.g. on a cluster or a cloud\) development and execution: Developing on a laptop is fast, whereas iterating with a remote cluster is slower. A laptop is a severely resource-constrained environment whereas a cluster can have virtually unlimited resources. Worse, simple local scripts may need to be translated to a new paradigm that is understood by a cluster."><meta data-react-helmet="true" property="og:description" content="Traditionally, there has been a tension between local \(e.g. on a laptop\) and remote \(e.g. on a cluster or a cloud\) development and execution: Developing on a laptop is fast, whereas iterating with a remote cluster is slower. A laptop is a severely resource-constrained environment whereas a cluster can have virtually unlimited resources. Worse, simple local scripts may need to be translated to a new paradigm that is understood by a cluster."><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.metaflow.org/metaflow-on-aws"><link data-react-helmet="true" rel="alternate" href="https://docs.metaflow.org/metaflow-on-aws" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.metaflow.org/metaflow-on-aws" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://5IZ8L9TJQL-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.bf7ddef0.css">
<link rel="preload" href="/assets/js/runtime~main.9f38e140.js" as="script">
<link rel="preload" href="/assets/js/main.871dc34a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Metaflow_Logo_Horizontal_OneColor_White_RGB.svg" alt="Metaflow Logo" class="themedImage_W2Cr themedImage--light_TfLj" height="64px"><img src="/img/Metaflow_Logo_Horizontal_OneColor_White_RGB.svg" alt="Metaflow Logo" class="themedImage_W2Cr themedImage--dark_oUvU" height="64px"></div></a><a class="navbar__item navbar__link navbar__link--active" href="/">Python Docs</a><a class="navbar__item navbar__link" href="/v/r">R Docs</a><a href="https://outerbounds.com/docs/admin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Admin Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Welcome to Metaflow for Python</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/introduction/why-metaflow">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/getting-started/install">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/metaflow-on-aws">Metaflow on AWS</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/metaflow-on-aws">Metaflow on AWS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/metaflow-on-aws/metaflow-sandbox">Metaflow Sandbox</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/metaflow-on-aws/deploy-to-aws">Deploying to AWS</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/metaflow/basics">Developing with Metaflow</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/going-to-production-with-metaflow/scheduling-metaflow-flows">Going to Production with Metaflow</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/internals-of-metaflow/technical-overview">Internals of Metaflow</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Metaflow on AWS</h1><p>Traditionally, there has been a tension between local <!-- -->(<!-- -->e.g. on a laptop<!-- -->)<!-- --> and remote <!-- -->(<!-- -->e.g. on a cluster or a cloud<!-- -->)<!-- --> development and execution: Developing on a laptop is fast, whereas iterating with a remote cluster is slower. A laptop is a severely resource-constrained environment whereas a cluster can have virtually unlimited resources. Worse, simple local scripts may need to be translated to a new paradigm that is understood by a cluster.</p><p>Metaflow tries to combine the best of both worlds. Most importantly, we support the same idiomatic Python scripts both locally and remotely. No changes in code or libraries needed. However, Metaflow doesn&#x27;t try to abstract away the fact that code is executed remotely. We believe that this is crucial in making troubleshooting easier.</p><p>Metaflow makes it easy to move back and forth between the local and remote modes of execution. You can even use a hybrid of the two approaches in a single workflow. This means that you can develop and test your Metaflow code similarly to any local Python script - simply and easily. When you need to <a href="/metaflow/scaling">process larger amounts of data</a>, or you want to deploy your workflow to production, you can do it with a single line of code or a single command.</p><p>When you set up a cloud-based object store as the datastore, Metaflow snapshots all data and code in the cloud automatically. This means that you can <a href="/metaflow/client">inspect</a>, <a href="/metaflow/debugging#how-to-use-the-resume-command">resume</a>, and restore any previous Metaflow execution without having to worry that the fruits of your hard work get lost.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="amazon-web-services">Amazon Web Services<a class="hash-link" href="#amazon-web-services" title="Direct link to heading">â€‹</a></h2><p>While technically Metaflow could work with any cloud provider, currently Metaflow supports only <a href="https://aws.amazon.com" target="_blank" rel="noopener noreferrer">Amazon Web Services</a> as the remote backend, thanks to Netflix&#x27;s decade-long experience with AWS.</p><p>The following table summarizes the integration between Metaflow and AWS:</p><table><thead><tr><th align="left">Service</th><th align="left">Local</th><th align="left">AWS</th></tr></thead><tbody><tr><td align="left"><strong>Datastore</strong></td><td align="left">Local Directory</td><td align="left"><a href="https://aws.amazon.com/s3/" target="_blank" rel="noopener noreferrer">Amazon S3</a></td></tr><tr><td align="left"><strong>Compute</strong></td><td align="left">Local Process</td><td align="left"><a href="https://aws.amazon.com/batch/" target="_blank" rel="noopener noreferrer">AWS Batch</a></td></tr><tr><td align="left"><strong>Metadata</strong></td><td align="left">Local Directory</td><td align="left"><a href="https://aws.amazon.com/fargate/" target="_blank" rel="noopener noreferrer">AWS Fargate</a> + <a href="https://aws.amazon.com/rds" target="_blank" rel="noopener noreferrer">Amazon RDS</a></td></tr><tr><td align="left"><strong>Notebooks</strong></td><td align="left">Local Notebook</td><td align="left"><a href="https://aws.amazon.com/sagemaker/" target="_blank" rel="noopener noreferrer">Amazon Sagemaker Notebooks</a></td></tr><tr><td align="left"><strong>Scheduling</strong></td><td align="left">-</td><td align="left"><a href="https://aws.amazon.com/step-functions/" target="_blank" rel="noopener noreferrer">AWS Step Functions</a> + <a href="https://aws.amazon.com/eventbridge/" target="_blank" rel="noopener noreferrer">Amazon EventBridge</a></td></tr><tr><td align="left"><strong>Large-scale ML</strong></td><td align="left">-</td><td align="left"><a href="https://aws.amazon.com/sagemaker/" target="_blank" rel="noopener noreferrer">Sagemaker Models</a>*</td></tr><tr><td align="left"><strong>Hosting</strong></td><td align="left">-</td><td align="left">*</td></tr></tbody></table><p>(<!-- -->*<!-- -->)<!-- --> <a href="/introduction/roadmap">available later</a></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="datastore"><strong>Datastore</strong><a class="hash-link" href="#datastore" title="Direct link to heading">â€‹</a></h3><p>Datastore is a centralized data repository for all the data that&#x27;s leveraged by and generated by Metaflow flows. In the local mode, all data artifacts are stored in a local directory. Metaflow integrates with Amazon S3 for cloud-scale storage so that you can process and persist larger amounts of data easily.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="compute">Compute<a class="hash-link" href="#compute" title="Direct link to heading">â€‹</a></h3><p>Metaflow executes all steps in the flow as a separate local process in local mode. To run larger workloads which require resources that might not be available on a laptop <!-- -->(<!-- -->think GPUs or 100s of GBs of RAM<!-- -->)<!-- -->, Metaflow integrates with AWS Batch to seamlessly run every step of the flow as a <!-- -->(<!-- -->or many<!-- -->)<!-- --> separate AWS Batch job<!-- -->(<!-- -->s<!-- -->)<!-- -->.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="metadata">Metadata<a class="hash-link" href="#metadata" title="Direct link to heading">â€‹</a></h3><p>Metaflow ships with a light-weight <a href="https://github.com/Netflix/metaflow-service" target="_blank" rel="noopener noreferrer">metaflow service</a> that provides a centralized place to keep track of all flow executions. This metadata service is not strictly needed. Metaflow will use a local directory to keep track of all executions from your laptop, even if you are using Amazon S3 as datastore or AWS Batch for <a href="#compute">compute</a>. You can use a local Jupyter notebook to interact with data artifacts from all your previous executions as well as currently running ones. However, deploying the metaflow service <!-- -->(<!-- -->as well as Amazon S3 as datastore<!-- -->)<!-- --> is helpful if you would like to share results with your peers and track your work without fear of losing any state.</p><p>At Netflix, all executions are logged in the metaflow service and all data artifacts are stored in Amazon S3, so that any data scientist can interface with anybody&#x27;s work via the <a href="/metaflow/client">client</a> and collaborate fruitfully. Also, a centralized metaflow service along with a data store like Amazon S3 makes it easy for data scientists at Netflix to use hosted notebooks to easily set-up dashboards to monitors their flows.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="notebooks">Notebooks<a class="hash-link" href="#notebooks" title="Direct link to heading">â€‹</a></h3><p>We are a <a href="https://netflixtechblog.com/notebook-innovation-591ee3221233" target="_blank" rel="noopener noreferrer">big fan of Notebooks</a> at Netflix. With Metaflow, users can easily create custom dashboards to monitor the execution of their Metaflow flows and track how their models are behaving in a very seamless manner. They can do that on their laptops with a local notebook or in the cloud with a hosted notebook solution. One such hosted solution is <a href="https://aws.amazon.com/sagemaker/" target="_blank" rel="noopener noreferrer">Sagemaker Notebooks</a> by AWS. For notebooks hosted in the cloud, you would want to ensure that you have configured the <a href="#metadata">metaflow service</a> and are using Amazon S3 for <a href="#datastore">datastore</a>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="scheduling">Scheduling<a class="hash-link" href="#scheduling" title="Direct link to heading">â€‹</a></h3><p>With Metaflow, users can create, prototype and execute flows from their laptops that can scale easily by leveraging elastic storage and compute capabilities in the cloud. Often, there comes a time, when these flows need to be run autonomously without any user intervention. At that point, Metaflow makes it easy to move the flow execution from Metaflow to AWS Step Functions to leverage all the feature sets that you get from a production grade scheduler - high availability, monitoring, reliability, etc. In addition, with AWS EventBridge, users can set triggers to execute these flows on a schedule automatically.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="using-metaflow-with-aws">Using Metaflow with AWS<a class="hash-link" href="#using-metaflow-with-aws" title="Direct link to heading">â€‹</a></h2><p>When you <code>pip install metaflow</code>for the first time, you start in the local mode. Artifacts and metadata are stored in a local directory and computation is performed with local processes. This mode is perfectly fine for personal use but if your use case involves more people and/or data, we recommend that you configure Metaflow to use AWS.</p><p>Even after Metaflow has been configured to use AWS, users can still choose to use local tools, e.g. for rapid prototyping. The easy back-and-forth between local and remote is a key value proposition of Metaflow. However, we recommend that you enable <strong>metadata</strong> and <strong>datastore</strong> to use AWS by default, which makes sure that all data stays persistent and everyone in the organization can benefit from the results of workflows.</p><p>Netflix uses this setup internally. To make the experience smoother, Netflix&#x27;s data scientists are provided with a <!-- -->(<!-- -->shared<!-- -->)<!-- --> EC2 instance where they can develop and test Metaflow code with minimal latency between their development environment and S3. Note that many IDEs such as <a href="https://code.visualstudio.com/" target="_blank" rel="noopener noreferrer">VSCode</a> or <a href="https://www.jetbrains.com/pycharm/" target="_blank" rel="noopener noreferrer">PyCharm</a> support execution on a remote instance natively.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="next-steps">Next Steps<a class="hash-link" href="#next-steps" title="Direct link to heading">â€‹</a></h2><p>If your organization doesn&#x27;t have an AWS account already, we provide a hosted sandbox environment where you can test Metaflow using your own code and data, to get a feel of the benefits of AWS. Read more in the section about <a href="/metaflow-on-aws/metaflow-sandbox">Metaflow Sandbox</a>.</p><p>If your organization has an AWS account already, see our <a href="https://outerbounds.com/docs/admin/metaflow-on-aws/deployment-guide" target="_blank" rel="noopener noreferrer">deployment guide</a> for detailed instructions on how to configure your account for Metaflow.</p><p>If you are already using Metaflow in your AWS account, and want to get started with how to manage various AWS resources, take a look at our <a href="https://outerbounds.com/docs/admin/metaflow-on-aws/operations-guide" target="_blank" rel="noopener noreferrer">operations guide</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.dev/Netflix/metaflow-docs/blob/new-docs/docs/metaflow-on-aws/metaflow-on-aws.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/getting-started/tutorials/season-2-scaling-out-and-up/episode-8-autopilot"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Episode 8: Autopilot</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/metaflow-on-aws/metaflow-sandbox"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Metaflow Sandbox</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#amazon-web-services" class="table-of-contents__link toc-highlight">Amazon Web Services</a><ul><li><a href="#datastore" class="table-of-contents__link toc-highlight"><strong>Datastore</strong></a></li><li><a href="#compute" class="table-of-contents__link toc-highlight">Compute</a></li><li><a href="#metadata" class="table-of-contents__link toc-highlight">Metadata</a></li><li><a href="#notebooks" class="table-of-contents__link toc-highlight">Notebooks</a></li><li><a href="#scheduling" class="table-of-contents__link toc-highlight">Scheduling</a></li></ul></li><li><a href="#using-metaflow-with-aws" class="table-of-contents__link toc-highlight">Using Metaflow with AWS</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.9f38e140.js"></script>
<script src="/assets/js/main.871dc34a.js"></script>
</body>
</html>