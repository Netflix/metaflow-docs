<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-production/coordinating-larger-metaflow-projects">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EYFXNGNGB6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-EYFXNGNGB6",{anonymize_ip:!0})</script><title data-rh="true">Coordinating Larger Metaflow Projects | Metaflow Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.metaflow.org/img/og-metaflow.png"><meta data-rh="true" name="twitter:image" content="https://docs.metaflow.org/img/og-metaflow.png"><meta data-rh="true" property="og:url" content="https://docs.metaflow.org/production/coordinating-larger-metaflow-projects"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="og:width" content="200"><meta data-rh="true" name="og:height" content="126"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Coordinating Larger Metaflow Projects | Metaflow Docs"><meta data-rh="true" name="description" content="This page applies equally to all [production"><meta data-rh="true" property="og:description" content="This page applies equally to all [production"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.metaflow.org/production/coordinating-larger-metaflow-projects"><link data-rh="true" rel="alternate" href="https://docs.metaflow.org/production/coordinating-larger-metaflow-projects" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.metaflow.org/production/coordinating-larger-metaflow-projects" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://5IZ8L9TJQL-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.3a1f2e37.css">
<link rel="preload" href="/assets/js/runtime~main.5d503d57.js" as="script">
<link rel="preload" href="/assets/js/main.65a3eaf6.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Metaflow_Logo_Horizontal_OneColor_DarkBlue_RGB.svg" alt="Metaflow Logo" class="themedImage_ToTc themedImage--light_HNdA" height="30"><img src="/img/Metaflow_Logo_Horizontal_OneColor_White_RGB.svg" alt="Metaflow Logo" class="themedImage_ToTc themedImage--dark_i4oU" height="30"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Python Docs</a><a class="navbar__item navbar__link" href="/v/r">R Docs</a><a href="https://outerbounds.com/docs/admin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Admin Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/Metaflow_Logo_Horizontal_OneColor_DarkBlue_RGB.svg" alt="Metaflow Logo" class="themedImage_ToTc themedImage--light_HNdA" height="30"><img src="/img/Metaflow_Logo_Horizontal_OneColor_White_RGB.svg" alt="Metaflow Logo" class="themedImage_ToTc themedImage--dark_i4oU" height="30"></a><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Welcome to Metaflow</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/introduction/why-metaflow">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/getting-started/install">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/metaflow/introduction">Developing with Metaflow</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developing with Metaflow&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/scaling/introduction">Scalable Flows</a><button aria-label="Toggle the collapsible sidebar category &#x27;Scalable Flows&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/production/introduction">Production Deployments</a><button aria-label="Toggle the collapsible sidebar category &#x27;Production Deployments&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/production/scheduling-metaflow-flows/introduction">Scheduling Metaflow Flows</a><button aria-label="Toggle the collapsible sidebar category &#x27;Scheduling Metaflow Flows&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/production/coordinating-larger-metaflow-projects">Coordinating Larger Metaflow Projects</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/production/event-triggering">Connecting Flows via Events</a><button aria-label="Toggle the collapsible sidebar category &#x27;Connecting Flows via Events&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/api">API Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;API Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/internals/release-notes">Internals of Metaflow</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/production/introduction"><span itemprop="name">Production Deployments</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Coordinating Larger Metaflow Projects</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Coordinating Larger Metaflow Projects</h1><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>This page applies equally to all <a href="/production/scheduling-metaflow-flows/introduction">production
orchestrators</a> supported by
Metaflow, i.e. AWS Step Functions, Argo Workflows, and Airflow. Examples below mention
<code>step-functions</code> but you can replace <code>step-functions</code> with <code>argo-workflows</code> or <code>airflow</code>
to get equivalent behavior on your orchestrator of choice (except the last part about
event triggering, which applies only to Argo Workflows).</p></div></div><p>Most Metaflow projects start as a simple Python script that is developed by a single
data scientist. Metaflow takes care of <a href="/scaling/tagging">keeping results organized
automatically</a>, so you can focus on developing models and the
business logic around them.</p><p>Over time, the project matures to the point that you want to deploy it to <a href="/production/scheduling-metaflow-flows/introduction">a production
orchestrator</a> to test how the model
works with real-life, updating data. In Metaflow, this is a matter of executing a single
command like <code>step-functions create</code>. Having the workflow run automatically with fresh
data is a great way to surface unforeseen issues in the code.</p><p>After a few iterations, the workflow starts to work reliably. If the results are
promising enough, stakeholders can start relying on the results of your workflow. Often,
success attracts more developers to join the project. At this point, you will need to
start thinking about how to coordinate work amongst multiple people and how to iterate
on new, experimental versions of the workflow while providing stable results to your
stakeholders. This is where the <code>@project</code> decorator comes in.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-project-decorator">The <code>@project</code> decorator<a class="hash-link" href="#the-project-decorator" title="Direct link to heading">​</a></h2><p>During development, multiple people can work on the same workflow simultaneously as
Metaflow keeps executions isolated through <a href="/scaling/tagging">independently stored artifacts and
namespaces</a>. However, by default, all production deployments are
bound to the name of the workflow. If multiple people call <code>step-functions create</code>
independently, each deployment will overwrite the previous one.</p><p>In the early stages of a project, this simple model is convenient but as the project
grows, it is desirable that multiple people can test their own production deployments
without interference. Or, as a single developer, you may want to experiment with
multiple independent deployments of your workflow.</p><p>Metaflow provides a <code>@project</code> decorator to address this need. The <code>@project</code> decorator
is used at the <code>FlowSpec</code>-level to bind a Flow to a specific project. All flows with the
same project name belong to the same project.</p><p>You can test this by executing the following flow.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">project_flow.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> metaflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> FlowSpec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> step</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> project</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> current</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@project</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;example_project&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ProjectFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FlowSpec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;project name:&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> current</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">project_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;project branch:&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> current</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">branch_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;is this a production run?&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> current</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">is_production</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ProjectFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Save the above snippet in a file, <code>project_flow.py</code>. Now you can run the flow as usual:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python project_flow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>@project</code> decorator exposes new project-related attributes, <code>project_name</code>,
<code>branch_name</code>, and <code>is_production</code> in <a href="/scaling/tagging#accessing-current-ids-in-a-flow">the current
object</a> which you can use to alter
the behavior of the flow depending on the execution context. Besides the new attributes
in current, the flow works exactly as before when executed outside a production
orchestrator.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="projects-in-production">Projects in production<a class="hash-link" href="#projects-in-production" title="Direct link to heading">​</a></h2><p>The main benefit of <code>@project</code> relates to deployments on <a href="/production/scheduling-metaflow-flows/introduction">a production
orchestrator</a>. Below, we will cover
this case: How to manage a production project with multiple developers collaborating.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="single-flow-multiple-developers">Single Flow, multiple developers<a class="hash-link" href="#single-flow-multiple-developers" title="Direct link to heading">​</a></h3><p>If <code>ProjectFlow</code> did not have a <code>@project decorator</code>, it would get deployed as a
workflow called <code>ProjectFlow</code> on AWS Step Functions by <code>step-functions create</code>. Only one
version of <code>ProjectFlow</code> could exist on a production orchestrator at a time. Everyone
deploying the flow would need to know <a href="/scaling/tagging#production-namespaces">the production
token</a> assigned to the deployment.</p><p>On the UI of your production orchestrator, you would see one workflow called
<code>ProjectFlow</code>:</p><p><img loading="lazy" src="data:image/png;base64,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lIjMmjXLmjVr5mqgjXNkejDcnDlzTHffcZn2zFG+ceahsk+cONG++eYbe//9961y5ZL/Tps3b7Znn33WtBX1aaeVHEXu06ePE5KLLrrIf9rqBRdcEBcO0oVArARK/vJjzYrET1UCCxcudFU/evSoLV682LSlpwQm7G5sFeHYtGlT8/KtSPiwYSSW55xzzr9EJDW95557zm0alHqOYwgkiQBCkqSrmeN1qVGjht188832+uuv2/r16/3Sbty40b788kvr37+/LVmyxL766itr3LixDRgwwCQInsmXUFRUZNrO4MILL3S7dNapU8f72o4dO2avvPKK/1kHnTp1sksuuaTEuR9++MGWLl3qhpU0vNSvXz+XX2qg4uJi09OuV65cafJjdOzY0dSL8Hwu7733nv38889ue1L1RF544QUX/aqrrnLCkppWJo7l7/niiy9cecRGmxCpbjLxkGgOGjToX4L1xx9/2GuvvWbXX399CZaZKBNpQMAjULK/7Z3lHQIxEfjnn39s9+7dVrduXT8HCcmMGTPs3nvvtWnTppl6Ltryc8KECX6Yjz/+2G699Vb74IMP7MiRI/bYY4/ZHXfcYYcOHfLD/P3337ZixQr/pTT1OdW0OdtNN91kb775ph0/ftyeeeYZu+GGG+ynn37yg0lEJk+ebIMHD3bCtnXrVnvwwQddft42CkpH4if7/fff/TwPHz7sp5OpA6UvP8r48ePtwIED9tlnn9ntt99ub731lp+F6uo57cVKvSCZRFDfSYgwCMRFgB5JXGRJ1yfw+eefu2M11p988om7k5dopNtvv/3mGm7d9asB9PZFkG9FjWjv3r1do1ipUiVTr0KCMGnSJHdOaVWvXt1eeuklP9l0n4N6LGqQr7jiCps5c6bzW4wZM8auvPJK1/A+/vjjLq56NRKyJ5980m688UZ3btu2bTZw4EArKChwnxVWgnfxxRfbnXfe6UTHzzjtQEJVpUoV/+zTTz9tHTp08D+Xd/DUU085P8rcuXOtc+fOJqFTvZ944gnXK2nXrp2ru3wy+l69E/Xc5LiX6MpatmxZXjZ8D4HQBBCS0OiIWFECo0eP9oOee+65zkGt3kW63Xffff7QUb169UzDRDI5s2WKIxGRtW7d2rp3726ffvqpqZfjnXdflvHnu+++c70HDQtJGDxTmdTD8GzRokUubU9EdF5+kNQZ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" width="402" height="84" class="img_ev3q"></p><p>The <code>@project</code> decorator changes this behavior. Let&#x27;s deploy <code>ProjectFlow</code>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python project_flow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py step</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">functions create</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>@project</code> decorator adds a user-specific prefix in the workflow name: the workflow
gets deployed with a name like <code>example_project.user.YOURNAME.ProjectFlow</code> where
<code>YOURNAME</code> is your username. Metaflow gets the username by looking, in order, at the
following environment variables: <code>METAFLOW_USER</code>, <code>SUDO_USER</code>, <code>USERNAME</code> and <code>USER</code>.</p><p>This allows multiple developers to deploy their workflows on a production orchestrator
without fear that they might interfere with someone else&#x27;s deployment. Imagine Alice,
Bob, and Carol collaborating on a project. Each one of them can call <code>step-functions
create</code> independently, which results in three separate workflows in production:</p><p><img loading="lazy" src="/assets/images/project_user-28351b3bdd6b86e62f88f3371632f4ab.png" width="412" height="221" class="img_ev3q"></p><p>Note that each one of these deployments gets <a href="/scaling/tagging">an isolated namespace</a>
and <a href="/scaling/tagging#production-tokens">a separate production token</a>. This means that
if your code refers to <code>Flow(&#x27;ProjectFlow&#x27;).latest_run</code> in production, it is guaranteed
to refer to a run that corresponds to its own isolated deployment. The deployments don&#x27;t
interfere with each other.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="main-production-deployment">Main production deployment<a class="hash-link" href="#main-production-deployment" title="Direct link to heading">​</a></h3><p>In addition to user-specific deployments, most projects have a single blessed production
version which represents the official results of the workflow.</p><p>The <code>@project</code> decorator exposes a new top-level command-line argument, <code>--production</code>
that denotes a production run or deployment. See what happens when you run ProjectFlow
with <code>--production</code>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python project_flow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">production run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>current.branch_name</code> will be set to prod and <code>current.is_production</code> is set to
True. For instance, you could write results to a production table only if
<code>current.is_production</code>.</p><p>You can deploy a production version to AWS Step Functions as follows:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python project_flow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">production step</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">functions create</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Instead of deploying the flow with a user-specific prefix, this will deploy the flow as
<code>example_project.prod.ProjectFlow</code>. You will get a warning about missing production
token if you are not authorized to deploy the flow to production.</p><p>The production deployment gets a separate, isolated namespace of its own:</p><p><img loading="lazy" src="/assets/images/project_prod-910994acd266cade98446a49bcb4fe60.png" width="402" height="277" class="img_ev3q"></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="custom-branches">Custom branches<a class="hash-link" href="#custom-branches" title="Direct link to heading">​</a></h3><p>Imagine that ProjectFlow has a stable version in production. Now, Alice and Bob want to
start developing a new, experimental version of the flow. They can work on a common
codebase and run the code locally independently. Eventually, they will want to deploy
the experimental version to a production orchestrator and let it run in parallel with
the production version for a while, to see that it works correctly.</p><p>Alice and Bob could deploy the experimental version under a user-specific namespace of
theirs but this would make it hard to keep iterating on the code, as one of the
usernamespaces would be reserved for the long-running experiment. A better approach is
to deploy the experimental code under a custom branch.</p><p>Try the following:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python project_flow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">branch better_version run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The flow reports that the branch name is <code>test.better_version</code>. You can deploy the
custom branch to AWS Step Functions:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python project_flow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">branch better_version step</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">functions create</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>which will result in another separate, isolated namespace:</p><p><img loading="lazy" src="/assets/images/project_branch-fa9d8a994728008777768f66b4a0503b.png" width="405" height="343" class="img_ev3q"></p><p>Alice and Bob can share the production token corresponding to the branch, so either of
them can redeploy the branch when needed.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="custom-branches-for-production-deployments">Custom branches for production deployments<a class="hash-link" href="#custom-branches-for-production-deployments" title="Direct link to heading">​</a></h3><p>There are scenarios where Alice might need to run multiple variants of ProjectFlow in
production. Alice can very simply use custom branches to run multiple production
versions -</p><p>Try the following:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python project_flow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">branch better_version </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">production run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The flow reports that the branch name is <code>prod.better_version</code>. You can deploy the
custom branch to AWS Step Functions:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python project_flow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">branch better_version </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">production step</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">functions create</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="project-and-event-triggering"><code>@project</code> and event triggering<a class="hash-link" href="#project-and-event-triggering" title="Direct link to heading">​</a></h3><p>Importantly, workflows connected through
<a href="/production/event-triggering/flow-events">the <code>@trigger_on_finish</code> decorator</a>
respect the <code>@project</code> decorator. Besides deploying individual workflows as branches,
as shown above, you can deploy flows-of-flows as isolated branches. Read more about
this pattern in
<a href="/production/event-triggering/project-events">Deploying Variants of Event-Triggered Flows</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">​</a></h2><p>The <code>@project</code> decorator makes available three classes of namespaces that will affect
the behavior of a production deployment:</p><ul><li><code>user</code> is the default. It will deploy to a user-specific, private namespace. Use it
for testing production deployments.</li><li><code>test</code> denotes custom branches that can be shared amongst multiple users. Use it for
deploying experimental versions that can run in parallel with production. Deploy
custom branches with <code>--branch foo</code>.</li><li><code>prod</code> denotes the global production namespace. Use it for deploying the official
production version of the project. Deploy to production with <code>--production</code>. For
multiple production variants, deploy custom branches with <code>--production --branch foo</code>.</li></ul><p>Note that the isolated namespaces offered by <code>@project</code> work best when your code is
designed to respect these boundaries. For instance, when writing results to a table, you
can use <code>current.branch_name</code> to choose the table to write to, or you can disable writes
outside production by checking <code>current.is_production</code>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.dev/Netflix/metaflow-docs/blob/master/docs/production/coordinating-larger-metaflow-projects.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/production/scheduling-metaflow-flows/scheduling-with-airflow"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Scheduling Metaflow Flows with Apache Airflow</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/production/event-triggering"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Connecting Flows via Events</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-project-decorator" class="table-of-contents__link toc-highlight">The <code>@project</code> decorator</a></li><li><a href="#projects-in-production" class="table-of-contents__link toc-highlight">Projects in production</a><ul><li><a href="#single-flow-multiple-developers" class="table-of-contents__link toc-highlight">Single Flow, multiple developers</a></li><li><a href="#main-production-deployment" class="table-of-contents__link toc-highlight">Main production deployment</a></li><li><a href="#custom-branches" class="table-of-contents__link toc-highlight">Custom branches</a></li><li><a href="#custom-branches-for-production-deployments" class="table-of-contents__link toc-highlight">Custom branches for production deployments</a></li><li><a href="#project-and-event-triggering" class="table-of-contents__link toc-highlight"><code>@project</code> and event triggering</a></li></ul></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.5d503d57.js"></script>
<script src="/assets/js/main.65a3eaf6.js"></script>
</body>
</html>