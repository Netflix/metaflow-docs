<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-api/S3">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EYFXNGNGB6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-EYFXNGNGB6",{anonymize_ip:!0})</script><title data-rh="true">S3 - Accessing data in S3 quickly | Metaflow Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.metaflow.org/img/og-metaflow.png"><meta data-rh="true" name="twitter:image" content="https://docs.metaflow.org/img/og-metaflow.png"><meta data-rh="true" property="og:url" content="https://docs.metaflow.org/api/S3"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="og:width" content="200"><meta data-rh="true" name="og:height" content="126"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="S3 - Accessing data in S3 quickly | Metaflow Docs"><meta data-rh="true" name="description" content="The S3 client is a wrapper over the standard AWS Python library, boto. It contains enhancements that are relevant for data-intensive applications:"><meta data-rh="true" property="og:description" content="The S3 client is a wrapper over the standard AWS Python library, boto. It contains enhancements that are relevant for data-intensive applications:"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.metaflow.org/api/S3"><link data-rh="true" rel="alternate" href="https://docs.metaflow.org/api/S3" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.metaflow.org/api/S3" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://5IZ8L9TJQL-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.57e5c9db.css">
<link rel="preload" href="/assets/js/runtime~main.fa2762c2.js" as="script">
<link rel="preload" href="/assets/js/main.f9ec58aa.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_jvwV"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Metaflow_Logo_Horizontal_OneColor_DarkBlue_RGB.svg" alt="Metaflow Logo" class="themedImage_ToTc themedImage--light_HNdA" height="30"><img src="/img/Metaflow_Logo_Horizontal_OneColor_White_RGB.svg" alt="Metaflow Logo" class="themedImage_ToTc themedImage--dark_i4oU" height="30"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Documentation</a><a href="https://outerbounds.com/docs/admin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Deployment Guide<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div style="display:flex;align-items:center"><div class="responsivePadding_cpaU" style="display:flex;align-items:center;gap:0.75rem"><a href="https://github.com/Netflix/metaflow" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><img src="/img/github.svg" alt="GitHub" class="logo_v_H3 githubLogo"></a><a href="http://slack.outerbounds.co/" target="_blank" rel="noopener noreferrer" aria-label="Slack"><img class="logo_v_H3" src="/img/slack.svg" alt="Slack"></a></div><div class="toggle_vylO colorModeToggle_x44X"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/Metaflow_Logo_Horizontal_OneColor_DarkBlue_RGB.svg" alt="Metaflow Logo" class="themedImage_ToTc themedImage--light_HNdA" height="30"><img src="/img/Metaflow_Logo_Horizontal_OneColor_White_RGB.svg" alt="Metaflow Logo" class="themedImage_ToTc themedImage--dark_i4oU" height="30"></a><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Welcome to Metaflow</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/introduction/why-metaflow">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/getting-started/install">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/metaflow/introduction">Developing Flows</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developing Flows&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/scaling/introduction">Scaling Flows</a><button aria-label="Toggle the collapsible sidebar category &#x27;Scaling Flows&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/production/introduction">Deploying to Production</a><button aria-label="Toggle the collapsible sidebar category &#x27;Deploying to Production&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/api">API Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;API Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/api/client">Client API - Accessing past results</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/api/flowspec">FlowSpec - Constructing flows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/api/current">Current - Operating a run</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/api/runner">Runner - Running flows programmatically</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/api/deployer">Deployer - Deploying flows programmatically</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/api/S3">S3 - Accessing data in S3 quickly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/api/cards">Cards - Visualizing results</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/api/argoevent">ArgoEvent - Create events to trigger flows</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/api/step-decorators">Step Decorators</a><button aria-label="Toggle the collapsible sidebar category &#x27;Step Decorators&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/api/flow-decorators">Flow Decorators</a><button aria-label="Toggle the collapsible sidebar category &#x27;Flow Decorators&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/internals/release-notes">Internals of Metaflow</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/api"><span itemprop="name">API Reference</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">S3 - Accessing data in S3 quickly</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>S3 - Accessing data in S3 quickly</h1><p>The <code>S3</code> client is a wrapper over the standard AWS Python library, <code>boto</code>. It contains enhancements that are relevant for data-intensive applications:</p><ul><li>Supports accessing large amounts of data quickly through parallel operations (functions with the <code>_many</code> suffix). You can download up to 20Gbps on a large EC2 instance.</li><li>Improved error handling.</li><li>Supports versioned data through <code>S3(run=self)</code> and <code>S3(run=Run)</code>.</li><li>User-friendly API with minimal boilerplate.</li><li>Convenient API for advanced featured such as range requests (downloading partial files) and object headers.</li></ul><p>For instructions how to use the class, see <a href="/scaling/data">Loading and Storing Data</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-s3-client">The <code>S3</code> client<a class="hash-link" href="#the-s3-client" title="Direct link to heading">​</a></h2><div class="docSection_qV9U"><a class="target_f8G0"></a><div class="titlebox__I0_"><h3 id="S3"><span class="name_dFHy"></span><span class="highlightedName_nmdb">S3</span><span>(<!-- -->tmproot=&#x27;.&#x27;, bucket=None, prefix=None, run=None, s3root=None<!-- -->)</span></h3><a class="hash-link" href="#S3" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/datatools/s3/s3.py#L452">[source]</a></div><p class="module_QJQj">from <!-- -->metaflow<!-- --> import <!-- -->S3</p><div class="content_g8IW"><div class="description_coNc"><span><p>The Metaflow S3 client.</p>
<p>This object manages the connection to S3 and a temporary diretory that is used
to download objects. Note that in most cases when the data fits in memory, no local
disk IO is needed as operations are cached by the operating system, which makes
operations fast as long as there is enough memory available.</p>
<p>The easiest way is to use this object as a context manager:</p>
<pre><code>with S3() as s3:
    data = [obj.blob for obj in s3.get_many(urls)]
print(data)
</code></pre>
<p>The context manager takes care of creating and deleting a temporary directory
automatically. Without a context manager, you must call <code>.close()</code> to delete
the directory explicitly:</p>
<pre><code>s3 = S3()
data = [obj.blob for obj in s3.get_many(urls)]
s3.close()
</code></pre>
<p>You can customize the location of the temporary directory with <code>tmproot</code>. It
defaults to the current working directory.</p>
<p>To make it easier to deal with object locations, the client can be initialized
with an S3 path prefix. There are three ways to handle locations:</p>
<ol>
<li>
<p>Use a <code>metaflow.Run</code> object or <code>self</code>, e.g. <code>S3(run=self)</code> which
initializes the prefix with the global <code>DATATOOLS_S3ROOT</code> path, combined
with the current run ID. This mode makes it easy to version data based
on the run ID consistently. You can use the <code>bucket</code> and <code>prefix</code> to
override parts of <code>DATATOOLS_S3ROOT</code>.</p>
</li>
<li>
<p>Specify an S3 prefix explicitly with <code>s3root</code>,
e.g. <code>S3(s3root='s3://mybucket/some/path')</code>.</p>
</li>
<li>
<p>Specify nothing, i.e. <code>S3()</code>, in which case all operations require
a full S3 url prefixed with <code>s3://</code>.</p>
</li>
</ol></span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Parameters<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>tmproot</strong>: <em>str, default: '.'</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Where to store the temporary directory.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>bucket</strong>: <em>str, optional</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Override the bucket from <code>DATATOOLS_S3ROOT</code> when <code>run</code> is specified.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>prefix</strong>: <em>str, optional</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Override the path from <code>DATATOOLS_S3ROOT</code> when <code>run</code> is specified.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>run</strong>: <em>FlowSpec or Run, optional</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Derive path prefix from the current or a past run ID, e.g. S3(run=self).</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>s3root</strong>: <em>str, optional</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>If <code>run</code> is not specified, use this as the S3 prefix.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3."></a><div class="titlebox__I0_"><h4 id="S3.close"><span class="name_dFHy">S3.</span><span class="highlightedName_nmdb">close</span><span>(<!-- -->self<!-- -->)</span></h4><a class="hash-link" href="#S3.close" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/datatools/s3/s3.py#L582">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Delete all temporary files downloaded in this context.</p>
</span></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="downloading-data">Downloading data<a class="hash-link" href="#downloading-data" title="Direct link to heading">​</a></h2><div class="docSection_qV9U"><a class="target_f8G0" id="S3."></a><div class="titlebox__I0_"><h4 id="S3.get"><span class="name_dFHy">S3.</span><span class="highlightedName_nmdb">get</span><span>(<span>self<!-- -->, </span><span>key<!-- -->, </span><span>return_missing<!-- -->, </span><span>return_info</span>)</span></h4><a class="hash-link" href="#S3.get" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/datatools/s3/s3.py#L859">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Get a single object from S3.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Parameters<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>key</strong>: <em>Union[str, S3GetObject], optional, default None</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Object to download. It can be an S3 url, a path suffix, or
an S3GetObject that defines a range of data to download. If None, or
not provided, gets the S3 root.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>return_missing</strong>: <em>bool, default False</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>If set to True, do not raise an exception for a missing key but
return it as an <code>S3Object</code> with <code>.exists == False</code>.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>return_info</strong>: <em>bool, default True</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>If set to True, fetch the content-type and user metadata associated
with the object at no extra cost, included for symmetry with <code>get_many</code></p></span></div></div></div></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>S3Object</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>An S3Object corresponding to the object requested.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3."></a><div class="titlebox__I0_"><h4 id="S3.get_many"><span class="name_dFHy">S3.</span><span class="highlightedName_nmdb">get_many</span><span>(<span>self<!-- -->, </span><span>keys<!-- -->, </span><span>return_missing<!-- -->, </span><span>return_info</span>)</span></h4><a class="hash-link" href="#S3.get_many" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/datatools/s3/s3.py#L964">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Get many objects from S3 in parallel.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Parameters<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>keys</strong>: <em>Iterable[Union[str, S3GetObject]]</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Objects to download. Each object can be an S3 url, a path suffix, or
an S3GetObject that defines a range of data to download.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>return_missing</strong>: <em>bool, default False</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>If set to True, do not raise an exception for a missing key but
return it as an <code>S3Object</code> with <code>.exists == False</code>.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>return_info</strong>: <em>bool, default True</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>If set to True, fetch the content-type and user metadata associated
with the object at no extra cost, included for symmetry with <code>get_many</code>.</p></span></div></div></div></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>List[S3Object]</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>S3Objects corresponding to the objects requested.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3."></a><div class="titlebox__I0_"><h4 id="S3.get_recursive"><span class="name_dFHy">S3.</span><span class="highlightedName_nmdb">get_recursive</span><span>(<span>self<!-- -->, </span><span>keys<!-- -->, </span><span>return_info</span>)</span></h4><a class="hash-link" href="#S3.get_recursive" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/datatools/s3/s3.py#L1039">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Get many objects from S3 recursively in parallel.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Parameters<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>keys</strong>: <em>Iterable[str]</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Prefixes to download recursively. Each prefix can be an S3 url or a path suffix
which define the root prefix under which all objects are downloaded.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>return_info</strong>: <em>bool, default False</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>If set to True, fetch the content-type and user metadata associated
with the object.</p></span></div></div></div></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>List[S3Object]</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>S3Objects stored under the given prefixes.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3."></a><div class="titlebox__I0_"><h4 id="S3.get_all"><span class="name_dFHy">S3.</span><span class="highlightedName_nmdb">get_all</span><span>(<span>self<!-- -->, </span><span>return_info</span>)</span></h4><a class="hash-link" href="#S3.get_all" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/datatools/s3/s3.py#L1095">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Get all objects under the prefix set in the <code>S3</code> constructor.</p>
<p>This method requires that the <code>S3</code> object is initialized either with <code>run</code> or
<code>s3root</code>.</p></span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Parameters<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>return_info</strong>: <em>bool, default False</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>If set to True, fetch the content-type and user metadata associated
with the object.</p></span></div></div></div></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>Iterable[S3Object]</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>S3Objects stored under the main prefix.</p></span></div></div></div></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="listing-objects">Listing objects<a class="hash-link" href="#listing-objects" title="Direct link to heading">​</a></h2><div class="docSection_qV9U"><a class="target_f8G0" id="S3."></a><div class="titlebox__I0_"><h4 id="S3.list_paths"><span class="name_dFHy">S3.</span><span class="highlightedName_nmdb">list_paths</span><span>(<span>self<!-- -->, </span><span>keys</span>)</span></h4><a class="hash-link" href="#S3.list_paths" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/datatools/s3/s3.py#L647">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>List the next level of paths in S3.</p>
<p>If multiple keys are specified, listings are done in parallel. The returned
S3Objects have <code>.exists == False</code> if the path refers to a prefix, not an
existing S3 object.</p>
<p>For instance, if the directory hierarchy is</p>
<pre><code>a/0.txt
a/b/1.txt
a/c/2.txt
a/d/e/3.txt
f/4.txt
</code></pre>
<p>The <code>list_paths(['a', 'f'])</code> call returns</p>
<pre><code>a/0.txt (exists == True)
a/b/ (exists == False)
a/c/ (exists == False)
a/d/ (exists == False)
f/4.txt (exists == True)
</code></pre></span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Parameters<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>keys</strong>: <em>Iterable[str], optional, default None</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>List of paths.</p></span></div></div></div></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>List[S3Object]</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>S3Objects under the given paths, including prefixes (directories) that
do not correspond to leaf objects.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3."></a><div class="titlebox__I0_"><h4 id="S3.list_recursive"><span class="name_dFHy">S3.</span><span class="highlightedName_nmdb">list_recursive</span><span>(<span>self<!-- -->, </span><span>keys</span>)</span></h4><a class="hash-link" href="#S3.list_recursive" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/datatools/s3/s3.py#L697">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>List all objects recursively under the given prefixes.</p>
<p>If multiple keys are specified, listings are done in parallel. All objects
returned have <code>.exists == True</code> as this call always returns leaf objects.</p>
<p>For instance, if the directory hierarchy is</p>
<pre><code>a/0.txt
a/b/1.txt
a/c/2.txt
a/d/e/3.txt
f/4.txt
</code></pre>
<p>The <code>list_paths(['a', 'f'])</code> call returns</p>
<pre><code>a/0.txt (exists == True)
a/b/1.txt (exists == True)
a/c/2.txt (exists == True)
a/d/e/3.txt (exists == True)
f/4.txt (exists == True)
</code></pre></span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Parameters<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>keys</strong>: <em>Iterable[str], optional, default None</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>List of paths.</p></span></div></div></div></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>List[S3Object]</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>S3Objects under the given paths.</p></span></div></div></div></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="uploading-data">Uploading data<a class="hash-link" href="#uploading-data" title="Direct link to heading">​</a></h2><div class="docSection_qV9U"><a class="target_f8G0" id="S3."></a><div class="titlebox__I0_"><h4 id="S3.put"><span class="name_dFHy">S3.</span><span class="highlightedName_nmdb">put</span><span>(<span>self<!-- -->, </span><span>key<!-- -->, </span><span>obj<!-- -->, </span><span>overwrite<!-- -->, </span><span>content_type<!-- -->, </span><span>metadata</span>)</span></h4><a class="hash-link" href="#S3.put" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/datatools/s3/s3.py#L1121">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Upload a single object to S3.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Parameters<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>key</strong>: <em>Union[str, S3PutObject]</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Object path. It can be an S3 url or a path suffix.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>obj</strong>: <em>PutValue</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>An object to store in S3. Strings are converted to UTF-8 encoding.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>overwrite</strong>: <em>bool, default True</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Overwrite the object if it exists. If set to False, the operation
succeeds without uploading anything if the key already exists.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>content_type</strong>: <em>str, optional, default None</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Optional MIME type for the object.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>metadata</strong>: <em>Dict[str, str], optional, default None</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>A JSON-encodable dictionary of additional headers to be stored
as metadata with the object.</p></span></div></div></div></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>str</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>URL of the object stored.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3."></a><div class="titlebox__I0_"><h4 id="S3.put_many"><span class="name_dFHy">S3.</span><span class="highlightedName_nmdb">put_many</span><span>(<span>self<!-- -->, </span><span>key_objs<!-- -->, </span><span>overwrite</span>)</span></h4><a class="hash-link" href="#S3.put_many" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/datatools/s3/s3.py#L1216">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Upload many objects to S3.</p>
<p>Each object to be uploaded can be specified in two ways:</p>
<ol>
<li>
<p>As a <code>(key, obj)</code> tuple where <code>key</code> is a string specifying
the path and <code>obj</code> is a string or a bytes object.</p>
</li>
<li>
<p>As a <code>S3PutObject</code> which contains additional metadata to be
stored with the object.</p>
</li>
</ol></span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Parameters<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>key_objs</strong>: <em>List[Union[Tuple[str, PutValue], S3PutObject]]</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>List of key-object pairs to upload.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>overwrite</strong>: <em>bool, default True</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Overwrite the object if it exists. If set to False, the operation
succeeds without uploading anything if the key already exists.</p></span></div></div></div></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>List[Tuple[str, str]]</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>List of <code>(key, url)</code> pairs corresponding to the objects uploaded.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3."></a><div class="titlebox__I0_"><h4 id="S3.put_files"><span class="name_dFHy">S3.</span><span class="highlightedName_nmdb">put_files</span><span>(<span>self<!-- -->, </span><span>key_paths<!-- -->, </span><span>overwrite</span>)</span></h4><a class="hash-link" href="#S3.put_files" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/datatools/s3/s3.py#L1290">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Upload many local files to S3.</p>
<p>Each file to be uploaded can be specified in two ways:</p>
<ol>
<li>
<p>As a <code>(key, path)</code> tuple where <code>key</code> is a string specifying
the S3 path and <code>path</code> is the path to a local file.</p>
</li>
<li>
<p>As a <code>S3PutObject</code> which contains additional metadata to be
stored with the file.</p>
</li>
</ol></span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Parameters<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>key_paths</strong>: <em>List[Union[Tuple[str, PutValue], S3PutObject]]</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>List of files to upload.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>overwrite</strong>: <em>bool, default True</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Overwrite the object if it exists. If set to False, the operation
succeeds without uploading anything if the key already exists.</p></span></div></div></div></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>List[Tuple[str, str]]</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>List of <code>(key, url)</code> pairs corresponding to the files uploaded.</p></span></div></div></div></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="querying-metadata">Querying metadata<a class="hash-link" href="#querying-metadata" title="Direct link to heading">​</a></h2><div class="docSection_qV9U"><a class="target_f8G0" id="S3."></a><div class="titlebox__I0_"><h4 id="S3.info"><span class="name_dFHy">S3.</span><span class="highlightedName_nmdb">info</span><span>(<span>self<!-- -->, </span><span>key<!-- -->, </span><span>return_missing</span>)</span></h4><a class="hash-link" href="#S3.info" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/datatools/s3/s3.py#L743">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Get metadata about a single object in S3.</p>
<p>This call makes a single <code>HEAD</code> request to S3 which can be
much faster than downloading all data with <code>get</code>.</p></span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Parameters<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>key</strong>: <em>str, optional, default None</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Object to query. It can be an S3 url or a path suffix.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>return_missing</strong>: <em>bool, default False</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>If set to True, do not raise an exception for a missing key but
return it as an <code>S3Object</code> with <code>.exists == False</code>.</p></span></div></div></div></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>S3Object</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>An S3Object corresponding to the object requested. The object
will have <code>.downloaded == False</code>.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3."></a><div class="titlebox__I0_"><h4 id="S3.info_many"><span class="name_dFHy">S3.</span><span class="highlightedName_nmdb">info_many</span><span>(<span>self<!-- -->, </span><span>keys<!-- -->, </span><span>return_missing</span>)</span></h4><a class="hash-link" href="#S3.info_many" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/datatools/s3/s3.py#L799">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Get metadata about many objects in S3 in parallel.</p>
<p>This call makes a single <code>HEAD</code> request to S3 which can be
much faster than downloading all data with <code>get</code>.</p></span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Parameters<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>keys</strong>: <em>Iterable[str]</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Objects to query. Each key can be an S3 url or a path suffix.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>return_missing</strong>: <em>bool, default False</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>If set to True, do not raise an exception for a missing key but
return it as an <code>S3Object</code> with <code>.exists == False</code>.</p></span></div></div></div></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>List[S3Object]</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>A list of S3Objects corresponding to the paths requested. The
objects will have <code>.downloaded == False</code>.</p></span></div></div></div></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="handling-results-with-s3object">Handling results with <code>S3Object</code><a class="hash-link" href="#handling-results-with-s3object" title="Direct link to heading">​</a></h2><p>Most operations above return <code>S3Object</code>s that encapsulate information about S3 paths and objects.</p><p>Note that the data itself is not kept in these objects but it is stored in a temporary directory which is accessible through the properties of this object.</p><div class="docSection_qV9U"><a class="target_f8G0"></a><div class="titlebox__I0_"><h3 id="S3Object"><span class="name_dFHy"></span><span class="highlightedName_nmdb">S3Object</span><span>(<!-- -->)</span></h3><a class="hash-link" href="#S3Object" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/datatools/s3/s3.py#L139">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>This object represents a path or an object in S3,
with an optional local copy.</p>
<p><code>S3Object</code>s are not instantiated directly, but they are returned
by many methods of the <code>S3</code> client.</p></span></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3Object."></a><div class="titlebox__I0_"><h4 id="S3Object.exists"><span class="name_dFHy">S3Object.</span><span class="highlightedName_nmdb">exists</span></h4><a class="hash-link" href="#S3Object.exists" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Does this key correspond to an object in S3?</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>bool</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>True if this object points at an existing object (file) in S3.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3Object."></a><div class="titlebox__I0_"><h4 id="S3Object.downloaded"><span class="name_dFHy">S3Object.</span><span class="highlightedName_nmdb">downloaded</span></h4><a class="hash-link" href="#S3Object.downloaded" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Has this object been downloaded?</p>
<p>If True, the contents can be accessed through <code>path</code>, <code>blob</code>,
and <code>text</code> properties.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>bool</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>True if the contents of this object have been downloaded.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3Object."></a><div class="titlebox__I0_"><h4 id="S3Object.url"><span class="name_dFHy">S3Object.</span><span class="highlightedName_nmdb">url</span></h4><a class="hash-link" href="#S3Object.url" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>S3 location of the object</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>str</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>The S3 location of this object.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3Object."></a><div class="titlebox__I0_"><h4 id="S3Object.prefix"><span class="name_dFHy">S3Object.</span><span class="highlightedName_nmdb">prefix</span></h4><a class="hash-link" href="#S3Object.prefix" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Prefix requested that matches this object.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>str</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Requested prefix</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3Object."></a><div class="titlebox__I0_"><h4 id="S3Object.key"><span class="name_dFHy">S3Object.</span><span class="highlightedName_nmdb">key</span></h4><a class="hash-link" href="#S3Object.key" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Key corresponds to the key given to the get call that produced
this object.</p>
<p>This may be a full S3 URL or a suffix based on what
was requested.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>str</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Key requested.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3Object."></a><div class="titlebox__I0_"><h4 id="S3Object.path"><span class="name_dFHy">S3Object.</span><span class="highlightedName_nmdb">path</span></h4><a class="hash-link" href="#S3Object.path" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Path to a local temporary file corresponding to the object downloaded.</p>
<p>This file gets deleted automatically when a S3 scope exits.
Returns None if this S3Object has not been downloaded.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>str</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Local path, if the object has been downloaded.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3Object."></a><div class="titlebox__I0_"><h4 id="S3Object.blob"><span class="name_dFHy">S3Object.</span><span class="highlightedName_nmdb">blob</span></h4><a class="hash-link" href="#S3Object.blob" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Contents of the object as a byte string or None if the
object hasn't been downloaded.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>bytes</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Contents of the object as bytes.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3Object."></a><div class="titlebox__I0_"><h4 id="S3Object.text"><span class="name_dFHy">S3Object.</span><span class="highlightedName_nmdb">text</span></h4><a class="hash-link" href="#S3Object.text" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Contents of the object as a string or None if the
object hasn't been downloaded.</p>
<p>The object is assumed to contain UTF-8 encoded data.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>str</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Contents of the object as text.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3Object."></a><div class="titlebox__I0_"><h4 id="S3Object.size"><span class="name_dFHy">S3Object.</span><span class="highlightedName_nmdb">size</span></h4><a class="hash-link" href="#S3Object.size" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Size of the object in bytes.</p>
<p>Returns None if the key does not correspond to an object in S3.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>int</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Size of the object in bytes, if the object exists.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3Object."></a><div class="titlebox__I0_"><h4 id="S3Object.has_info"><span class="name_dFHy">S3Object.</span><span class="highlightedName_nmdb">has_info</span></h4><a class="hash-link" href="#S3Object.has_info" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Returns true if this <code>S3Object</code> contains the content-type MIME header or
user-defined metadata.</p>
<p>If False, this means that <code>content_type</code>, <code>metadata</code>, <code>range_info</code> and
<code>last_modified</code> will return None.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>bool</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>True if additional metadata is available.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3Object."></a><div class="titlebox__I0_"><h4 id="S3Object.metadata"><span class="name_dFHy">S3Object.</span><span class="highlightedName_nmdb">metadata</span></h4><a class="hash-link" href="#S3Object.metadata" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Returns a dictionary of user-defined metadata, or None if no metadata
is defined.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>Dict</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>User-defined metadata.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3Object."></a><div class="titlebox__I0_"><h4 id="S3Object.content_type"><span class="name_dFHy">S3Object.</span><span class="highlightedName_nmdb">content_type</span></h4><a class="hash-link" href="#S3Object.content_type" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Returns the content-type of the S3 object or None if it is not defined.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>str</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Content type or None if the content type is undefined.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3Object."></a><div class="titlebox__I0_"><h4 id="S3Object.range_info"><span class="name_dFHy">S3Object.</span><span class="highlightedName_nmdb">range_info</span></h4><a class="hash-link" href="#S3Object.range_info" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>If the object corresponds to a partially downloaded object, returns
information of what was downloaded.</p>
<p>The returned object has the following fields:</p>
<ul>
<li><code>total_size</code>: Size of the object in S3.</li>
<li><code>request_offset</code>: The starting offset.</li>
<li><code>request_length</code>: The number of bytes downloaded.</li>
</ul>
</span></div></div></div><div class="docSection_qV9U"><a class="target_f8G0" id="S3Object."></a><div class="titlebox__I0_"><h4 id="S3Object.last_modified"><span class="name_dFHy">S3Object.</span><span class="highlightedName_nmdb">last_modified</span></h4><a class="hash-link" href="#S3Object.last_modified" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><div class="content_g8IW"><div class="description_coNc"><span><p>Returns the last modified unix timestamp of the object.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Returns<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><em>int</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Unix timestamp corresponding to the last modified time.</p></span></div></div></div></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="helper-objects">Helper Objects<a class="hash-link" href="#helper-objects" title="Direct link to heading">​</a></h2><p>These objects are simple containers that are used to pass information to <code>get_many</code>, <code>put_many</code>, and <code>put_files</code>. You may use your own objects instead of them, as long as they provide the same set of attributes.</p><div class="docSection_qV9U"><a class="target_f8G0"></a><div class="titlebox__I0_"><h3 id="S3GetObject"><span class="name_dFHy"></span><span class="highlightedName_nmdb">S3GetObject</span><span>(<span>key<!-- -->, </span><span>offset<!-- -->, </span><span>length</span>)</span></h3><a class="hash-link" href="#S3GetObject" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><p class="module_QJQj">from <!-- -->metaflow.datatools.s3<!-- --> import <!-- -->S3GetObject</p><div class="content_g8IW"><div class="description_coNc"><span><p>Represents a chunk of an S3 object. A range query is performed to download only a subset of data,
<code>object[key][offset:offset + length]</code>, from S3.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Attributes<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>key</strong>: <em>str</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Key identifying the object. Works the same way as any <code>key</code> passed to <code>get</code> or <code>get_many</code>.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>offset</strong>: <em>int</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>A byte offset in the file.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>length</strong>: <em>int</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>The number of bytes to download.</p></span></div></div></div></div></div></div><div class="docSection_qV9U"><a class="target_f8G0"></a><div class="titlebox__I0_"><h3 id="S3PutObject"><span class="name_dFHy"></span><span class="highlightedName_nmdb">S3PutObject</span><span>(<span>key<!-- -->, </span><span>value<!-- -->, </span><span>path<!-- -->, </span><span>content_type<!-- -->, </span><span>metadata</span>)</span></h3><a class="hash-link" href="#S3PutObject" title="Direct link to heading">​</a><a class="source_eDXS" href="https://github.com/Netflix/metaflow/tree/master/">[source]</a></div><p class="module_QJQj">from <!-- -->metaflow.datatools.s3<!-- --> import <!-- -->S3PutObject</p><div class="content_g8IW"><div class="description_coNc"><span><p>Defines an object with metadata to be uplaoded with <code>put_many</code> or <code>put_files</code>.</p>
</span></div><div class="wrapper_DVhX"><div class="paramSectionName_xY3j"><strong>Attributes<!-- --> </strong></div><div class="paramSectionChildren_V5gE"><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>key</strong>: <em>str</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Key identifying the object. Works the same way as <code>key</code> passed to <code>put</code> or <code>put_many</code>.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>value</strong>: <em>str or bytes</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Object to upload. Works the same way as <code>obj</code> passed <code>to </code>put<code>or</code>put_many`.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>path</strong>: <em>str</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Path to a local file. Works the same way as <code>path</code> passed to <code>put_files</code>.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>content_type</strong>: <em>str</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>Optional MIME type for the file.</p></span></div></div><div class="parameter_UtYT"><div class="parameterName_xp1q"><span><p><strong>metadata</strong>: <em>Dict</em></p></span></div><div class="parameterContent_PmvG"><span class="content_LeDY"><p>A JSON-encodable dictionary of additional headers to be stored
as metadata with the file.</p></span></div></div></div></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.dev/Netflix/metaflow-docs/blob/master/docs/api/S3.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/api/deployer"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Deployer - Deploying flows programmatically</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/api/cards"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Cards - Visualizing results</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-s3-client" class="table-of-contents__link toc-highlight">The <code>S3</code> client</a></li><li><a href="#downloading-data" class="table-of-contents__link toc-highlight">Downloading data</a></li><li><a href="#listing-objects" class="table-of-contents__link toc-highlight">Listing objects</a></li><li><a href="#uploading-data" class="table-of-contents__link toc-highlight">Uploading data</a></li><li><a href="#querying-metadata" class="table-of-contents__link toc-highlight">Querying metadata</a></li><li><a href="#handling-results-with-s3object" class="table-of-contents__link toc-highlight">Handling results with <code>S3Object</code></a></li><li><a href="#helper-objects" class="table-of-contents__link toc-highlight">Helper Objects</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.fa2762c2.js"></script>
<script src="/assets/js/main.f9ec58aa.js"></script>
</body>
</html>