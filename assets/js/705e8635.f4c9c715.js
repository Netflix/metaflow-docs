"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[7791],{3681:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>u,contentTitle:()=>s,default:()=>c,frontMatter:()=>l,metadata:()=>r,toc:()=>p});var n=a(7462),i=(a(7294),a(3905)),o=a(2004);const l={},s="Setting Up the Dev Stack",r={unversionedId:"getting-started/devstack",id:"getting-started/devstack",title:"Setting Up the Dev Stack",description:"You can start writing and running flows just by installing Metaflow locally with",source:"@site/docs/getting-started/devstack.md",sourceDirName:"getting-started",slug:"/getting-started/devstack",permalink:"/getting-started/devstack",draft:!1,editUrl:"https://github.dev/Netflix/metaflow-docs/blob/master/docs/getting-started/devstack.md",tags:[],version:"current",frontMatter:{},sidebar:"python",previous:{title:"Installing Metaflow",permalink:"/getting-started/install"},next:{title:"Deploying Infrastructure for Metaflow",permalink:"/getting-started/infrastructure"}},u={},p=[{value:"When to use <code>metaflow-dev</code>",id:"when-to-use-metaflow-dev",level:2},{value:"How to set up the dev stack",id:"how-to-set-up-the-dev-stack",level:2},{value:"The dev stack in action",id:"the-dev-stack-in-action",level:3},{value:"Using the dev stack in a CI/CD pipeline",id:"using-the-dev-stack-in-a-cicd-pipeline",level:2}],d={toc:p};function c(t){let{components:e,...a}=t;return(0,i.kt)("wrapper",(0,n.Z)({},d,a,{components:e,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"setting-up-the-dev-stack"},"Setting Up the Dev Stack"),(0,i.kt)("p",null,"You can start writing and running flows just by installing Metaflow locally with\n",(0,i.kt)("inlineCode",{parentName:"p"},"pip install metaflow"),". However, its true power lies in its integration with underlying\ninfrastructure, which allows you to"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/scaling/remote-tasks/introduction"},"run tasks in the cloud at any scale"),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/metaflow/visualizing-results"},"visualize and observe them in a UI"),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/production/introduction"},"deploy them in a highly available production orchestrator"),","),(0,i.kt)("li",{parentName:"ul"},"and compose reactive systems with ",(0,i.kt)("a",{parentName:"li",href:"/production/event-triggering"},"event-triggered flows"),".")),(0,i.kt)("p",null,"All of these features require an infrastructure stack that needs to be configured to work\nwith Metaflow. In production settings, this infrastructure runs in your cloud account -\nas ",(0,i.kt)("a",{parentName:"p",href:"/getting-started/infrastructure"},"described on this page")," - but you may want to test the\nfull stack first locally."),(0,i.kt)("p",null,"Metaflow comes with a one-click script, ",(0,i.kt)("inlineCode",{parentName:"p"},"metaflow-dev"),", which sets up a complete\ndevelopment stack for you locally on top of ",(0,i.kt)("a",{parentName:"p",href:"https://minikube.sigs.k8s.io/docs/"},"Minikube"),",\nincluding a local metadata service and a database, and ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/Netflix/metaflow-ui"},"Metaflow UI"),".\nThe stack allows you to ",(0,i.kt)("a",{parentName:"p",href:"/scaling/remote-tasks/kubernetes"},"test scaling with ",(0,i.kt)("inlineCode",{parentName:"a"},"@kubernetes")),",\n",(0,i.kt)("a",{parentName:"p",href:"/production/scheduling-metaflow-flows/scheduling-with-argo-workflows"},"deployment on Argo Workflows"),",\nas well as ",(0,i.kt)("a",{parentName:"p",href:"/production/event-triggering"},"event-triggering"),"."),(0,i.kt)("h2",{id:"when-to-use-metaflow-dev"},"When to use ",(0,i.kt)("inlineCode",{parentName:"h2"},"metaflow-dev")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"metaflow-dev")," stack comes in handy in a few scenarios:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"It allows you to ",(0,i.kt)("strong",{parentName:"p"},"test the full functionality of Metaflow")," before ",(0,i.kt)("a",{parentName:"p",href:"/getting-started/infrastructure"},"deploying it in your cloud account"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"You can use it ",(0,i.kt)("strong",{parentName:"p"},"in your CI/CD workflows to test flows")," in a fully isolated, ephemeral environment.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"If you want to ",(0,i.kt)("strong",{parentName:"p"},"contribute extensions for Metaflow"),", or make changes in the core Metaflow, the stack\nprovides you a complete development and testing environment."))),(0,i.kt)("h2",{id:"how-to-set-up-the-dev-stack"},"How to set up the dev stack"),(0,i.kt)("p",null,"Setting up the stack is straightforward:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Install Metaflow with ",(0,i.kt)("inlineCode",{parentName:"li"},"pip install metaflow"),"."),(0,i.kt)("li",{parentName:"ol"},"Ensure that ",(0,i.kt)("a",{parentName:"li",href:"https://docs.docker.com/desktop/"},"you have Docker installed"),"."),(0,i.kt)("li",{parentName:"ol"},"Run ",(0,i.kt)("inlineCode",{parentName:"li"},"metaflow-dev up"),".")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"metaflow-dev")," command downloads and installs Minikube. After this, it uses ",(0,i.kt)("a",{parentName:"p",href:"https://tilt.dev/"},"Tilt")," to deploy\nand expose ",(0,i.kt)("a",{parentName:"p",href:"/internals/technical-overview"},"all components required by Metaflow")," inside Minikube."),(0,i.kt)("p",null,"After the deployment completes, leave the shell running ",(0,i.kt)("inlineCode",{parentName:"p"},"metaflow-dev up")," open, as it hosts necessary port\nforwardings. On the side, open a new shell and execute\n",(0,i.kt)("inlineCode",{parentName:"p"},"metaflow-dev shell"),". This will open a session with a Metaflow configuration pointing at the local stack.\nYou can now use the shell to develop, run, and deploy Metaflow flows!"),(0,i.kt)("p",null,"You can navigate to the Tilt UI, linked in the console output, to find links to the Metaflow and Argo Workflows UIs.\nYou can find direct links to the UI in the Metaflow output as well."),(0,i.kt)("h3",{id:"the-dev-stack-in-action"},"The dev stack in action"),(0,i.kt)("p",null,"Watch this short video (no sound) for a quick setup-to-usage walkthrough:"),(0,i.kt)(o.Z,{controls:!0,url:"https://www.youtube.com/watch?v=nPtqj72hfKU",mdxType:"ReactPlayer"}),(0,i.kt)("br",null),(0,i.kt)("p",null,"The video covers:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Setting up the dev stack"),(0,i.kt)("li",{parentName:"ul"},"Observing the stack through the Tilt UI"),(0,i.kt)("li",{parentName:"ul"},"Using the stack to run and monitor runs"),(0,i.kt)("li",{parentName:"ul"},"Running at scale with ",(0,i.kt)("inlineCode",{parentName:"li"},"@kubernetes")),(0,i.kt)("li",{parentName:"ul"},"Inspecting results in a notebook, accessing metadata"),(0,i.kt)("li",{parentName:"ul"},"Deploying to Argo Workflows"),(0,i.kt)("li",{parentName:"ul"},"Tearing down the stack")),(0,i.kt)("h2",{id:"using-the-dev-stack-in-a-cicd-pipeline"},"Using the dev stack in a CI/CD pipeline"),(0,i.kt)("p",null,"The dev stack is lightweight enough to run in small CI/CD worker nodes, including those provided by GitHub Actions. You\ncan use the stack to run integration tests for flows in a fully isolated, ephemeral environment."),(0,i.kt)("p",null,"Take a look at ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/outerbounds/gha-metaflow/"},"this example repository")," and\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/outerbounds/gha-metaflow/blob/main/.github/workflows/metaflow.yml"},"a GitHub Actions config")," for\na template that you can easily apply in your own setup."))}c.isMDXComponent=!0}}]);