"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[6021],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=o.createContext({}),u=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return o.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=u(n),h=a,m=d["".concat(s,".").concat(h)]||d[h]||c[h]||r;return n?o.createElement(m,i(i({ref:t},p),{},{components:n})):o.createElement(m,i({ref:t},p))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var u=2;u<r;u++)i[u]=n[u];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},9659:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>u});var o=n(7462),a=(n(7294),n(3905));const r={},i="Production Deployments",l={unversionedId:"production/introduction",id:"production/introduction",title:"Production Deployments",description:"What does production mean exactly? Surely the answer depends on who you ask and what",source:"@site/docs/production/introduction.md",sourceDirName:"production",slug:"/production/introduction",permalink:"/production/introduction",draft:!1,editUrl:"https://github.dev/Netflix/metaflow-docs/blob/master/docs/production/introduction.md",tags:[],version:"current",frontMatter:{},sidebar:"python",previous:{title:"Organizing Results",permalink:"/scaling/tagging"},next:{title:"Scheduling Metaflow Flows",permalink:"/production/scheduling-metaflow-flows/introduction"}},s={},u=[{value:"Reliably Running, Automated Flows",id:"reliably-running-automated-flows",level:2},{value:"Patterns of production deployments",id:"patterns-of-production-deployments",level:3},{value:"To Production And Back",id:"to-production-and-back",level:2},{value:"What You Will Learn",id:"what-you-will-learn",level:2}],p={toc:u};function c(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,o.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"production-deployments"},"Production Deployments"),(0,a.kt)("p",null,"What does ",(0,a.kt)("em",{parentName:"p"},"production")," mean exactly? Surely the answer depends on who you ask and what\napplication they are working on. There are so many different ways to produce business\nvalue with machine learning and data science that there can't be a single unambiguous\ndefinition or a way to deploy projects to production."),(0,a.kt)("p",null,"However, there are characteristics that are common to all production deployments:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Production deployments should ",(0,a.kt)("strong",{parentName:"p"},"run without human intervention"),". It is not very\npractical to use results that require you to execute ",(0,a.kt)("inlineCode",{parentName:"p"},"run")," on your laptop to power\nserious business processes or products.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Production deployments should ",(0,a.kt)("strong",{parentName:"p"},"run reliably")," in a highly available manner. Results\nshould appear predictably, even if infrastructure encounters spurious failures."))),(0,a.kt)("p",null,"Consider the Metaflow journey"),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(7195).Z,width:"703",height:"540"})),(0,a.kt)("p",null,"Thus far the steps have involved a human in the loop, from ",(0,a.kt)("a",{parentName:"p",href:"/metaflow/introduction"},"local\ndevelopment")," to ",(0,a.kt)("a",{parentName:"p",href:"/scaling/introduction"},"scalable flows"),". In\ncontrast, a defining feature of production deployments is that they are fully automated.\nWe achieve this by ",(0,a.kt)("em",{parentName:"p"},"scheduling flows")," to run automatically on ",(0,a.kt)("em",{parentName:"p"},"a production-grade\nworkflow orchestrator"),", so you don't need to write ",(0,a.kt)("inlineCode",{parentName:"p"},"run")," manually to produce the desired\nresults."),(0,a.kt)("h2",{id:"reliably-running-automated-flows"},"Reliably Running, Automated Flows"),(0,a.kt)("p",null,"What about the second characteristic of production deployments - reliability? Firstly, a\nbig benefit of ",(0,a.kt)("a",{parentName:"p",href:"/scaling/introduction"},"Stage II")," is that you can test your workflows at\nscale, and add ",(0,a.kt)("a",{parentName:"p",href:"/scaling/failures"},"reliability-enhancing"),"\n",(0,a.kt)("a",{parentName:"p",href:"/scaling/dependencies"},"features"),", making sure your flows can cope with production-scale\nworkloads. Secondly, your flow needs to be orchestrated by a system that by itself runs\nreliably, which is ",(0,a.kt)("a",{parentName:"p",href:"https://netflixtechblog.com/unbundling-data-science-workflows-with-metaflow-and-aws-step-functions-d454780c6280"},"harder than it\nsounds"),".\nSuch a production-grade orchestrator needs to be"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Highly available"),": The orchestrator itself must not crash, even if a server it\nruns on hits a random failure.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Highly scalable"),": We shouldn't have to worry about the number flows orchestrated\nby the system.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Capable of triggering flows based on different conditions"),": We should be able to\nautomate flow execution flexibly.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Easy to monitor and operate"),": To minimize the time spent on occasional human\ninterventions."))),(0,a.kt)("p",null,"Fortunately, a few systems are able to fulfill these requirements, judging by their\ntrack record. Metaflow integrates with two of them: ",(0,a.kt)("a",{parentName:"p",href:"https://argoproj.github.io/argo-workflows/"},"Argo\nWorkflows")," that runs on Kubernetes and ",(0,a.kt)("a",{parentName:"p",href:"https://aws.amazon.com/step-functions/"},"AWS\nStep Functions"),", a managed service by AWS. As\nof today, Argo Workflows is the only orchestrator that supports\n",(0,a.kt)("a",{parentName:"p",href:"/production/event-triggering"},"Metaflow's powerful event-triggering functionality"),",\nwhich makes it a good default choice."),(0,a.kt)("p",null,"In addition, Metaflow integrates with a popular open-source workflow orchestrator,\n",(0,a.kt)("a",{parentName:"p",href:"https://airflow.apache.org/"},"Apache Airflow"),". While Airflow has more limitations than\nthe two aforementioned orchestrators, it is a good choice if you have many DAGs deployed\non it already and you don't want to introduce a new orchestrator in your environment."),(0,a.kt)("p",null,"While all of these systems are quite complex under the hood, Metaflow makes using them\ntrivial: You can deploy your flows literally with a single command - no changes in the\ncode required. Also, this means that you can switch between schedulers easily. For\ninstance, you can start with Apache Airflow to stay compatible with your existing data\npipelines and migrate to Argo Workflows over time without having to pay any migration\ntax."),(0,a.kt)("h3",{id:"patterns-of-production-deployments"},"Patterns of production deployments"),(0,a.kt)("p",null,"Once flows run reliably, you can leverage the results - like freshly trained models - on\nvarious systems:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"You can use deployed workflows as building blocks to compose larger systems using\n",(0,a.kt)("a",{parentName:"li",href:"/production/event-triggering"},"event triggering"),"."),(0,a.kt)("li",{parentName:"ol"},"You can write fresh predictions or other results in a data warehouse, e.g. to power a\ndashboard."),(0,a.kt)("li",{parentName:"ol"},"You can populate fresh results in a cache e.g. for a recommendation system."),(0,a.kt)("li",{parentName:"ol"},"You can deploy models on a ",(0,a.kt)("em",{parentName:"li"},"model hosting")," platform of your choosing, e.g.\n",(0,a.kt)("a",{parentName:"li",href:"https://www.seldon.io/"},"Seldon")," or ",(0,a.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/sagemaker/latest/dg/how-it-works-deployment.html"},"AWS\nSagemaker"),".")),(0,a.kt)("p",null,"The exact pattern depends on your use case. Importantly, creating these integrations\nbecome much easier when you can trust your flows to run reliably. We are happy to help\nyou on ",(0,a.kt)("a",{parentName:"p",href:"http://slack.outerbounds.co"},"the Metaflow support Slack")," to find a pattern that\nworks for your needs."),(0,a.kt)("h2",{id:"to-production-and-back"},"To Production And Back"),(0,a.kt)("p",null,"While the journey illustration above looks like a linear path from prototype to\nproduction, realistically the picture should illustrate loops everywhere. In particular,\nthere is constant interaction between local development and production deployments, as\nyou troubleshoot production issues (inevitably), as well as keep working on newer\nversions of flows. "),(0,a.kt)("p",null,"When it comes to troubleshooting, a hugely convenient feature is the ability to\n",(0,a.kt)("a",{parentName:"p",href:"/metaflow/debugging#reproducing-production-issues-locally"},(0,a.kt)("inlineCode",{parentName:"a"},"resume")," failed production runs\nlocally"),". Also, remember that\nyou can inspect the state of any production run with\n",(0,a.kt)("a",{parentName:"p",href:"/metaflow/visualizing-results"},"cards")," and ",(0,a.kt)("a",{parentName:"p",href:"/metaflow/client"},"notebooks"),", in real-time."),(0,a.kt)("p",null,"When it comes to working on newer versions, how do you know if a newer version performs\nbetter than the latest production deployment? Often, the best way to answer the question\nis to deploy the new version to run concurrently with the existing production version\nand compare the results, as in an A/B test. This pattern is enabled by ",(0,a.kt)("a",{parentName:"p",href:"coordinating-larger-metaflow-projects"},"the ",(0,a.kt)("inlineCode",{parentName:"a"},"@project"),"\ndecorator"),". Also, ",(0,a.kt)("a",{parentName:"p",href:"https://outerbounds.com/blog/five-ways-to-use-the-new-metaflow-tags/"},"Metaflow\ntags")," come in\nhandy when designing processes around production deployments."),(0,a.kt)("h2",{id:"what-you-will-learn"},"What You Will Learn"),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"You can get a feel of all these concepts and test them hands-on without having to\ninstall anything locally by signing up for\n",(0,a.kt)("a",{parentName:"p",href:"https://metaflow.org/sandbox/"},"a Metaflow Sandbox"),"!")),(0,a.kt)("p",null,"In this section, you will learn how to make your flows run automatically without any\nhuman intervention. "),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"The basics of ",(0,a.kt)("a",{parentName:"p",href:"/production/scheduling-metaflow-flows/introduction"},"scheduling Metaflow flows"),":"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Depending on the ",(0,a.kt)("a",{parentName:"li",href:"/getting-started/infrastructure"},"infrastructure you have\ninstalled"),", pick a section below:",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/production/scheduling-metaflow-flows/scheduling-with-argo-workflows"},"Scheduling flows with Argo\nWorkflows"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Choose this if running on Kubernetes."))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/production/scheduling-metaflow-flows/scheduling-with-aws-step-functions"},"Scheduling flows with AWS Step\nFunctions"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Choose for minimal operational overhead."))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/production/scheduling-metaflow-flows/scheduling-with-airflow"},"Scheduling flows with Apache\nAirflow"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Choose to stay compatible with your existing Airflow deployment."))))))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"/production/coordinating-larger-metaflow-projects"},"Coordinating larger Metaflow\nprojects")," is a more advanced pattern\nthat enables multiple parallel production deployments.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"/production/event-triggering"},"Connecting flows via events")," shows how you can\nmake workflows start automatically based on real-time events. This pattern\nallows you to build reactive systems using flows as building blocks."))))}c.isMDXComponent=!0},7195:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/intro-cartoon-3-ac6f165bca661f279d06c6f06a04ac2a.svg"}}]);