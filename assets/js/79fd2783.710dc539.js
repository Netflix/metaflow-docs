"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[7780],{3905:(e,t,r)=>{r.d(t,{Zo:()=>m,kt:()=>d});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var p=n.createContext({}),u=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},m=function(e){var t=u(e.components);return n.createElement(p.Provider,{value:t},e.children)},l={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,p=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),c=u(r),d=o,f=c["".concat(p,".").concat(d)]||c[d]||l[d]||a;return r?n.createElement(f,s(s({ref:t},m),{},{components:r})):n.createElement(f,s({ref:t},m))}));function d(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,s=new Array(a);s[0]=c;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var u=2;u<a;u++)s[u]=r[u];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}c.displayName="MDXCreateElement"},9093:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>k,frontMatter:()=>a,metadata:()=>i,toc:()=>u});var n=r(7462),o=(r(7294),r(3905));const a={},s="@kubernetes",i={unversionedId:"api/step-decorators/kubernetes",id:"api/step-decorators/kubernetes",title:"@kubernetes",description:"The @kubernetes decorator sends a step for execution on a Kubernetes cluster. For more information, see Executing Tasks Remotely.",source:"@site/docs/api/step-decorators/kubernetes.md",sourceDirName:"api/step-decorators",slug:"/api/step-decorators/kubernetes",permalink:"/api/step-decorators/kubernetes",draft:!1,editUrl:"https://github.dev/Netflix/metaflow-docs/blob/master/docs/api/step-decorators/kubernetes.md",tags:[],version:"current",frontMatter:{},sidebar:"python",previous:{title:"@pypi",permalink:"/api/step-decorators/pypi"},next:{title:"@resources",permalink:"/api/step-decorators/resources"}},p={},u=[],m=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",t)},l=m("DocSection"),c=m("SigArgSection"),d=m("SigArg"),f=m("Description"),h=m("ParamSection"),y=m("Parameter"),b={toc:u};function k(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,n.Z)({},b,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"kubernetes"},"@kubernetes"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"@kubernetes")," decorator sends a step for execution on a ",(0,o.kt)("a",{parentName:"p",href:"https://kubernetes.io"},"Kubernetes")," cluster. For more information, see ",(0,o.kt)("a",{parentName:"p",href:"/scaling/remote-tasks/introduction"},"Executing Tasks Remotely"),"."),(0,o.kt)("p",null,"For options related to ",(0,o.kt)("inlineCode",{parentName:"p"},"tmpfs"),", see ",(0,o.kt)("a",{parentName:"p",href:"/scaling/data#using-metaflows3-for-in-memory-processing"},"Using ",(0,o.kt)("inlineCode",{parentName:"a"},"metaflow.S3")," for in-memory processing"),"."),(0,o.kt)(l,{type:"decorator",name:"kubernetes",module:"metaflow",show_import:"True",heading_level:"3",link:"https://github.com/Netflix/metaflow/tree/master/metaflow/plugins/kubernetes/kubernetes_decorator.py#L54",mdxType:"DocSection"},(0,o.kt)(c,{mdxType:"SigArgSection"},(0,o.kt)(d,{name:"...",mdxType:"SigArg"})),(0,o.kt)(f,{summary:"Specifies that this step should execute on Kubernetes.",mdxType:"Description"}),(0,o.kt)(h,{name:"Parameters",mdxType:"ParamSection"},(0,o.kt)(y,{name:"cpu",type:"int, default 1",desc:"Number of CPUs required for this step. If `@resources` is\\nalso present, the maximum value from all decorators is used.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"memory",type:"int, default 4096",desc:"Memory size (in MB) required for this step. If\\n`@resources` is also present, the maximum value from all decorators is\\nused.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"disk",type:"int, default 10240",desc:"Disk size (in MB) required for this step. If\\n`@resources` is also present, the maximum value from all decorators is\\nused.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"image",type:"str, optional, default None",desc:"Docker image to use when launching on Kubernetes. If not specified, and\\nMETAFLOW_KUBERNETES_CONTAINER_IMAGE is specified, that image is used. If\\nnot, a default Docker image mapping to the current version of Python is used.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"image_pull_policy: str, default KUBERNETES_IMAGE_PULL_POLICY",desc:"If given, the imagePullPolicy to be applied to the Docker image of the step.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"image_pull_secrets: List[str], default []",desc:"The default is extracted from METAFLOW_KUBERNETES_IMAGE_PULL_SECRETS.\\nKubernetes image pull secrets to use when pulling container images\\nin Kubernetes.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"service_account",type:"str, default METAFLOW_KUBERNETES_SERVICE_ACCOUNT",desc:"Kubernetes service account to use when launching pod in Kubernetes.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"secrets",type:"List[str], optional, default None",desc:"Kubernetes secrets to use when launching pod in Kubernetes. These\\nsecrets are in addition to the ones defined in `METAFLOW_KUBERNETES_SECRETS`\\nin Metaflow configuration.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"node_selector: Union[Dict[str,str], str], optional, default None",desc:"Kubernetes node selector(s) to apply to the pod running the task.\\nCan be passed in as a comma separated string of values e.g.\\n'kubernetes.io/os=linux,kubernetes.io/arch=amd64' or as a dictionary\\n{'kubernetes.io/os': 'linux', 'kubernetes.io/arch': 'amd64'}",mdxType:"Parameter"}),(0,o.kt)(y,{name:"namespace",type:"str, default METAFLOW_KUBERNETES_NAMESPACE",desc:"Kubernetes namespace to use when launching pod in Kubernetes.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"gpu",type:"int, optional, default None",desc:"Number of GPUs required for this step. A value of zero implies that\\nthe scheduled node should not have GPUs.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"gpu_vendor",type:"str, default KUBERNETES_GPU_VENDOR",desc:"The vendor of the GPUs to be used for this step.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"tolerations",type:"List[Dict[str,str]], default []",desc:"The default is extracted from METAFLOW_KUBERNETES_TOLERATIONS.\\nKubernetes tolerations to use when launching pod in Kubernetes.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"labels: Dict[str, str], default: METAFLOW_KUBERNETES_LABELS",desc:"Kubernetes labels to use when launching pod in Kubernetes.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"annotations: Dict[str, str], default: METAFLOW_KUBERNETES_ANNOTATIONS",desc:"Kubernetes annotations to use when launching pod in Kubernetes.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"use_tmpfs",type:"bool, default False",desc:"This enables an explicit tmpfs mount for this step.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"tmpfs_tempdir",type:"bool, default True",desc:"sets METAFLOW_TEMPDIR to tmpfs_path if set for this step.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"tmpfs_size",type:"int, optional, default: None",desc:"The value for the size (in MiB) of the tmpfs mount for this step.\\nThis parameter maps to the `--tmpfs` option in Docker. Defaults to 50% of the\\nmemory allocated for this step.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"tmpfs_path",type:"str, optional, default /metaflow_temp",desc:"Path to tmpfs mount for this step.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"persistent_volume_claims",type:"Dict[str, str], optional, default None",desc:"A map (dictionary) of persistent volumes to be mounted to the pod for this step. The map is from persistent\\nvolumes to the path to which the volume is to be mounted, e.g., `{'pvc-name': '/path/to/mount/on'}`.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"shared_memory: int, optional",desc:"Shared memory size (in MiB) required for this step",mdxType:"Parameter"}),(0,o.kt)(y,{name:"port: int, optional",desc:"Port number to specify in the Kubernetes job object",mdxType:"Parameter"}),(0,o.kt)(y,{name:"compute_pool",type:"str, optional, default None",desc:"Compute pool to be used for for this step.\\nIf not specified, any accessible compute pool within the perimeter is used.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"hostname_resolution_timeout: int, default 10 * 60",desc:"Timeout in seconds for the workers tasks in the gang scheduled cluster to resolve the hostname of control task.\\nOnly applicable when @parallel is used.",mdxType:"Parameter"}),(0,o.kt)(y,{name:"qos: str, default: Burstable",desc:"Quality of Service class to assign to the pod. Supported values are: Guaranteed, Burstable, BestEffort",mdxType:"Parameter"}),(0,o.kt)(y,{name:"security_context: Dict[str, Any], optional, default None",desc:"Container security context. Applies to the task container. Allows the following keys:\\n- privileged: bool, optional, default None\\n- allow_privilege_escalation: bool, optional, default None\\n- run_as_user: int, optional, default None\\n- run_as_group: int, optional, default None\\n- run_as_non_root: bool, optional, default None",mdxType:"Parameter"}))))}k.isMDXComponent=!0}}]);