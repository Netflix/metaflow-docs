<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-scaling/remote-tasks/introduction">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EYFXNGNGB6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-EYFXNGNGB6",{anonymize_ip:!0})</script><title data-rh="true">Computing at Scale | Metaflow Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.metaflow.org/img/og-metaflow.png"><meta data-rh="true" name="twitter:image" content="https://docs.metaflow.org/img/og-metaflow.png"><meta data-rh="true" property="og:url" content="https://docs.metaflow.org/scaling/remote-tasks/introduction"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="og:width" content="200"><meta data-rh="true" name="og:height" content="126"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Computing at Scale | Metaflow Docs"><meta data-rh="true" name="description" content="Metaflow makes it easy to run compute in the cloud. Instead of prescribing one paradigm for all"><meta data-rh="true" property="og:description" content="Metaflow makes it easy to run compute in the cloud. Instead of prescribing one paradigm for all"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.metaflow.org/scaling/remote-tasks/introduction"><link data-rh="true" rel="alternate" href="https://docs.metaflow.org/scaling/remote-tasks/introduction" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.metaflow.org/scaling/remote-tasks/introduction" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://5IZ8L9TJQL-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.57e5c9db.css">
<link rel="preload" href="/assets/js/runtime~main.46b91267.js" as="script">
<link rel="preload" href="/assets/js/main.f9ec58aa.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_jvwV"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Metaflow_Logo_Horizontal_OneColor_DarkBlue_RGB.svg" alt="Metaflow Logo" class="themedImage_ToTc themedImage--light_HNdA" height="30"><img src="/img/Metaflow_Logo_Horizontal_OneColor_White_RGB.svg" alt="Metaflow Logo" class="themedImage_ToTc themedImage--dark_i4oU" height="30"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Documentation</a><a href="https://outerbounds.com/docs/admin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Deployment Guide<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div style="display:flex;align-items:center"><div class="responsivePadding_cpaU" style="display:flex;align-items:center;gap:0.75rem"><a href="https://github.com/Netflix/metaflow" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><img src="/img/github.svg" alt="GitHub" class="logo_v_H3 githubLogo"></a><a href="http://slack.outerbounds.co/" target="_blank" rel="noopener noreferrer" aria-label="Slack"><img class="logo_v_H3" src="/img/slack.svg" alt="Slack"></a></div><div class="toggle_vylO colorModeToggle_x44X"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/Metaflow_Logo_Horizontal_OneColor_DarkBlue_RGB.svg" alt="Metaflow Logo" class="themedImage_ToTc themedImage--light_HNdA" height="30"><img src="/img/Metaflow_Logo_Horizontal_OneColor_White_RGB.svg" alt="Metaflow Logo" class="themedImage_ToTc themedImage--dark_i4oU" height="30"></a><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Welcome to Metaflow</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/introduction/why-metaflow">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/getting-started/install">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/metaflow/introduction">Developing Flows</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developing Flows&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/scaling/introduction">Scaling Flows</a><button aria-label="Toggle the collapsible sidebar category &#x27;Scaling Flows&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" tabindex="0" href="/scaling/remote-tasks/introduction">Computing at Scale</a><button aria-label="Toggle the collapsible sidebar category &#x27;Computing at Scale&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/scaling/remote-tasks/requesting-resources">Requesting Compute Resources</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/scaling/remote-tasks/multicore">Using Multiple CPU Cores</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/scaling/remote-tasks/spot-instances">Using Spot Instances</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/scaling/remote-tasks/controlling-parallelism">Controlling Parallelism</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/scaling/remote-tasks/gpu-compute">Using GPUs and Other Accelerators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/scaling/remote-tasks/installing-drivers-and-frameworks">Installing Drivers and Frameworks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/scaling/remote-tasks/distributed-computing">Distributed Computing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/scaling/remote-tasks/kubernetes">Using Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/scaling/remote-tasks/aws-batch">Using AWS Batch</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/scaling/dependencies">Managing Dependencies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Managing Dependencies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scaling/failures">Dealing with Failures</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/scaling/checkpoint/introduction">Checkpointing Progress</a><button aria-label="Toggle the collapsible sidebar category &#x27;Checkpointing Progress&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scaling/data">Loading and Storing Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scaling/tagging">Organizing Results</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scaling/secrets">Accessing Secrets</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/production/introduction">Deploying to Production</a><button aria-label="Toggle the collapsible sidebar category &#x27;Deploying to Production&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/api">API Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;API Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/internals/release-notes">Internals of Metaflow</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/scaling/introduction"><span itemprop="name">Scaling Flows</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Computing at Scale</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Computing at Scale</h1><p>Metaflow makes it easy to run compute in the cloud. Instead of prescribing one paradigm for all
compute needs, Metaflow allows you to mix and match various patterns of scalable compute,
keeping simple things simple while making advanced use cases possible.</p><p>When your needs are modest, you can
run Metaflow as any Python code, such as a notebook or a local script. When you need more
compute power, say to train a model on GPUs or to handle a large dataframe, you can get the
job done by adding a line code. Or, you can execute even thousands of such tasks in parallel
or train a large model, such as an LLM, over many GPUs.</p><p>When your needs grow, you can even <a href="/scaling/remote-tasks/requesting-resources#mixing-cloud-environments">mix and match various compute
environments</a> to
create advanced workflows that operate across local, on-premise data centers, and
various public clouds.</p><p>Below, we provide an overview of the patterns of compute that Metaflow supports with pointers
for more details. Importantly, you can mix and match these patterns freely, even in a single
flow.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>To enable the cloud computing capabilities of Metaflow - <code>@batch</code> and <code>@kubernetes</code> - you need to
<a href="/getting-started/infrastructure">deploy a Metaflow stack</a> first. To test these concepts
before deploying, <a href="https://outerbounds.com/sandbox/" target="_blank" rel="noopener noreferrer">try the Metaflow Sandbox</a>.</p></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="rapid-development-with-local-execution">Rapid development with local execution<a class="hash-link" href="#rapid-development-with-local-execution" title="Direct link to heading">​</a></h2><p>When you run a flow without special decorators, e.g.
<a href="/metaflow/basics#linear">run <code>LinearFlow</code> by typing <code>python linear.py run</code></a>,
the flow runs locally on your computer like any Python script or a notebook.</p><div style="width:100%;height:100%"></div><p>This allows you to develop and test code rapidly without having to rely on any infrastructure
outside your workstation.</p><p>Running your code as a flow can provide an immediate performance benefit: If your flow has
<a href="/metaflow/basics#branch">branches</a> or <a href="/metaflow/basics#foreach">foreaches</a>,
Metaflow leverages multiple CPU cores to speed up compute by running parallel tasks as separate
processes. In addition to Metaflow parallelizing tasks, you can speed up compute by using
optimized Python libraries such as <a href="https://pytorch.org/" target="_blank" rel="noopener noreferrer">PyTorch</a> to leverage GPUs or a library
like
<a href="https://xgboost.readthedocs.io/en/stable/" target="_blank" rel="noopener noreferrer">XGBoost</a> that can utilize multiple CPU cores.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="parallelizing-python-over-multiple-cpu-cores">Parallelizing Python over multiple CPU cores<a class="hash-link" href="#parallelizing-python-over-multiple-cpu-cores" title="Direct link to heading">​</a></h3><p>If you need to execute a medium amount of compute - too much to handle in sequential Python
code but not enough to warrant parallel tasks using <code>foreach</code> - <a href="/scaling/remote-tasks/multicore">Metaflow provides a helper function,
<code>parallel_map</code></a> that parallelizes execution of a Python function over multiple CPU cores.
For instance, you can use <code>parallel_map</code> to process a list of 10M items in batches of 1M items
in parallel.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="requesting-compute-resources">Requesting compute <code>@resources</code><a class="hash-link" href="#requesting-compute-resources" title="Direct link to heading">​</a></h2><p>If your job requires more resources than what is available on your workstation, e.g. more
memory or more GPUs, Metaflow makes it easy to run the task remotely on a cloud instance:
<a href="/scaling/remote-tasks/requesting-resources">Simply annotate the step with the <code>@resources</code> decorator</a>.</p><div style="width:100%;height:100%"></div><p>In this case, Metaflow executes the task remotely in the cloud using <a href="/getting-started/infrastructure">one of the supported compute
backends</a>, AWS Batch or Kubernetes.</p><p>This is often the easiest way
to scale up compute to handle larger datasets or models. It is like getting a bigger computer with
a line of code. While larger cloud instances cost more, they are only needed for as long as a
<code>@step</code> executes, so this approach can be cost-effective as well. This manner of scaling is called
<a href="https://en.wikipedia.org/wiki/Scalability#Vertical_or_scale_up" target="_blank" rel="noopener noreferrer"><em>vertical scaling</em></a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="requesting-gpus-and-other-hardware-accelerators">Requesting GPUs and other hardware accelerators<a class="hash-link" href="#requesting-gpus-and-other-hardware-accelerators" title="Direct link to heading">​</a></h3><p>ML/AI workloads often require hardware acceleration such as GPUs. Learn more on <a href="/scaling/remote-tasks/gpu-compute">a dedicated
page about hardware-accelerated compute</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="saving-money-with-spot-instances">Saving money with spot instances<a class="hash-link" href="#saving-money-with-spot-instances" title="Direct link to heading">​</a></h3><p>You can reduce your cloud costs by utilizing spot instances. Besides <a href="/scaling/failures#retrying-tasks-with-the-retry-decorator">retrying tasks
automatically</a> when spot instances
are terminated, Metaflow allows you to <a href="/scaling/remote-tasks/spot-instances">exit and clean up tasks gracefully</a>
before termination.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="executing-steps-in-parallel">Executing steps in parallel<a class="hash-link" href="#executing-steps-in-parallel" title="Direct link to heading">​</a></h2><p>If you want to execute two or more <code>@step</code>s in parallel, <a href="/metaflow/basics#branch">make them <code>branch</code></a>.</p><div style="width:100%;height:100%"></div><p>When you run a flow with branches locally, each <code>@step</code> is run in a process of its own, taking
advantage of multiple CPU cores in your workstation to speed up processing. When you <a href="/scaling/remote-tasks/requesting-resources">execute the
flow (or some of its steps) remotely</a>, each <code>@step</code> is
run in a separate container, allowing you to run even thousands of steps in parallel.</p><p>Branches come in handy in two scenarios:</p><ol><li><p>You have separate operations that can be executed independently.</p></li><li><p>You want to allocate separate <code>@resources</code> (or other decorators) for different sets of data, e.g.
to build a small model with CPUs and a large one with GPUs. Just create branches, each with their
own set of decorators.</p></li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="running-many-tasks-in-parallel-with-foreach">Running many tasks in parallel with <code>foreach</code><a class="hash-link" href="#running-many-tasks-in-parallel-with-foreach" title="Direct link to heading">​</a></h2><p>A very common scenario in ML, AI, and data processing is to run the same operation, e.g. data
transformation or model training, for each shard of data or a set of parameters.</p><div style="width:100%;height:100%"></div><p>Metaflow&#x27;s <a href="/metaflow/basics#foreach"><code>foreach</code></a> is similar to
<a href="https://realpython.com/python-map-function/" target="_blank" rel="noopener noreferrer">Python&#x27;s built-in <code>map</code> function</a> which allows
you to apply a function - or in the case of Metaflow, a <code>@step</code> - to all elements in a list.</p><p>The difference to <code>branch</code> is that <code>foreach</code> applies <strong>the same operation</strong> to all elements,
utilizing <a href="https://en.wikipedia.org/wiki/Data_parallelism" target="_blank" rel="noopener noreferrer"><em>data parallelism</em></a>, whereas <code>branch</code>
applies <strong>a different operation</strong> to each, utilizing
<a href="https://en.wikipedia.org/wiki/Task_parallelism" target="_blank" rel="noopener noreferrer"><em>task parallelism</em></a>.</p><p>The superpower of Metaflow is that you can <a href="/scaling/remote-tasks/requesting-resources">run these tasks in parallel</a>,
processing even thousands of items concurrently in the cloud. Hence you can use foreaches to
process large datasets, train many models, or run hyperparameter searches in parallel, that is,
execute any <a href="https://en.wikipedia.org/wiki/Embarrassingly_parallel" target="_blank" rel="noopener noreferrer"><em>embarrassingly parallel</em></a>
operations that can benefit from
<a href="https://en.wikipedia.org/wiki/Scalability#Horizontal_or_scale_out" target="_blank" rel="noopener noreferrer"><em>horizontal scaling</em></a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="options-for-controlling-parallelism">Options for controlling parallelism<a class="hash-link" href="#options-for-controlling-parallelism" title="Direct link to heading">​</a></h3><p>Note that regardless of the size of your list to <code>foreach</code> over, you can control the number
of tasks actually run in parallel with <a href="#">the <code>--max-workers</code> flag</a>. Also you will want to
<a href="#">increase <code>--max-num-splits</code> when you list is long</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="distributed-computing-with-ephemeral-compute-clusters">Distributed computing with ephemeral compute clusters<a class="hash-link" href="#distributed-computing-with-ephemeral-compute-clusters" title="Direct link to heading">​</a></h2><p>The most advanced pattern of compute that Metaflow supports is distributed computing. In
this case, Metaflow sets up a cluster of instances on the fly which can communicate with
each other, e.g. to train a Large Language Model (LLM) over many GPU instances.</p><div style="width:100%;height:100%"></div><p>While there are many other ways to set up such clusters, a major benefit of Metaflow is
that you can <em>embed an ephemeral cluster</em> as a part of a larger workflow, instead of having
to maintain the cluster separately. Learn more on <a href="/scaling/remote-tasks/distributed-computing">a dedicated page about distributed
computing</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.dev/Netflix/metaflow-docs/blob/master/docs/scaling/remote-tasks/introduction.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/scaling/introduction"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Scalable Compute and Data</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/scaling/remote-tasks/requesting-resources"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Requesting Compute Resources</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#rapid-development-with-local-execution" class="table-of-contents__link toc-highlight">Rapid development with local execution</a><ul><li><a href="#parallelizing-python-over-multiple-cpu-cores" class="table-of-contents__link toc-highlight">Parallelizing Python over multiple CPU cores</a></li></ul></li><li><a href="#requesting-compute-resources" class="table-of-contents__link toc-highlight">Requesting compute <code>@resources</code></a><ul><li><a href="#requesting-gpus-and-other-hardware-accelerators" class="table-of-contents__link toc-highlight">Requesting GPUs and other hardware accelerators</a></li><li><a href="#saving-money-with-spot-instances" class="table-of-contents__link toc-highlight">Saving money with spot instances</a></li></ul></li><li><a href="#executing-steps-in-parallel" class="table-of-contents__link toc-highlight">Executing steps in parallel</a></li><li><a href="#running-many-tasks-in-parallel-with-foreach" class="table-of-contents__link toc-highlight">Running many tasks in parallel with <code>foreach</code></a><ul><li><a href="#options-for-controlling-parallelism" class="table-of-contents__link toc-highlight">Options for controlling parallelism</a></li></ul></li><li><a href="#distributed-computing-with-ephemeral-compute-clusters" class="table-of-contents__link toc-highlight">Distributed computing with ephemeral compute clusters</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.46b91267.js"></script>
<script src="/assets/js/main.f9ec58aa.js"></script>
</body>
</html>