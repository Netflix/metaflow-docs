<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-v/r/metaflow-on-aws/metaflow-on-aws">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EYFXNGNGB6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-EYFXNGNGB6",{anonymize_ip:!0})</script><title data-rh="true">Metaflow on AWS | Metaflow Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.metaflow.org/img/og-metaflow.png"><meta data-rh="true" name="twitter:image" content="https://docs.metaflow.org/img/og-metaflow.png"><meta data-rh="true" property="og:url" content="https://docs.metaflow.org/v/r/metaflow-on-aws"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="og:width" content="200"><meta data-rh="true" name="og:height" content="126"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Metaflow on AWS | Metaflow Docs"><meta data-rh="true" name="description" content="Traditionally, there has been a tension between local \(e.g. on a laptop\) and remote"><meta data-rh="true" property="og:description" content="Traditionally, there has been a tension between local \(e.g. on a laptop\) and remote"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.metaflow.org/v/r/metaflow-on-aws"><link data-rh="true" rel="alternate" href="https://docs.metaflow.org/v/r/metaflow-on-aws" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.metaflow.org/v/r/metaflow-on-aws" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://5IZ8L9TJQL-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.3a1f2e37.css">
<link rel="preload" href="/assets/js/runtime~main.81c8b9a4.js" as="script">
<link rel="preload" href="/assets/js/main.93f3962d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Metaflow_Logo_Horizontal_OneColor_DarkBlue_RGB.svg" alt="Metaflow Logo" class="themedImage_ToTc themedImage--light_HNdA" height="30"><img src="/img/Metaflow_Logo_Horizontal_OneColor_White_RGB.svg" alt="Metaflow Logo" class="themedImage_ToTc themedImage--dark_i4oU" height="30"></div></a><a class="navbar__item navbar__link" href="/">Python Docs</a><a class="navbar__item navbar__link" href="/v/r">R Docs</a><a href="https://outerbounds.com/docs/admin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Admin Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Metaflow on AWS</h1><p>Traditionally, there has been a tension between local <!-- -->(<!-- -->e.g. on a laptop<!-- -->)<!-- --> and remote
<!-- -->(<!-- -->e.g. on a cluster or a cloud<!-- -->)<!-- --> development and execution: Developing on a laptop is
fast, whereas iterating with a remote cluster is slower. A laptop is a severely
resource-constrained environment whereas a cluster can have virtually unlimited
resources. Worse, simple local scripts may need to be translated to a new paradigm that
is understood by a cluster.</p><p>Metaflow tries to combine the best of both worlds. Most importantly, we support the same
idiomatic R scripts both locally and remotely. No changes in code or libraries needed.
However, Metaflow doesn&#x27;t try to abstract away the fact that code is executed remotely.
We believe that this is crucial in making troubleshooting easier.</p><p>Metaflow makes it easy to move back and forth between the local and remote modes of
execution. You can even use a hybrid of the two approaches in a single workflow. This
means that you can develop and test your Metaflow code similarly to any local R script -
simply and easily. When you need to <a href="/v/r/metaflow/scaling">process larger amounts of
data</a>, or you want to deploy your workflow to production, you
can do it with a single line of code or a single command.</p><p>When you set up a cloud-based object store as the datastore, Metaflow snapshots all data
and code in the cloud automatically. This means that you can
<a href="/v/r/metaflow/client">inspect</a>,
<a href="/v/r/metaflow/debugging#how-to-use-the-resume-command">resume</a>, and restore any
previous Metaflow execution without having to worry that the fruits of your hard work
get lost.</p><blockquote><p>Note that the R and Python versions of Metaflow work the same way on AWS since they
both share the same AWS integrations. The instructions here and in the <a href="https://outerbounds.com/docs/admin" target="_blank" rel="noopener noreferrer">Admin
Docs</a> apply to both versions.</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="amazon-web-services">Amazon Web Services<a class="hash-link" href="#amazon-web-services" title="Direct link to heading">​</a></h2><p>While technically Metaflow could work with any cloud provider, currently Metaflow
supports only <a href="https://aws.amazon.com" target="_blank" rel="noopener noreferrer">Amazon Web Services</a> as the remote backend,
thanks to Netflix&#x27;s decade-long experience with AWS.</p><p>The following table summarizes the integration between Metaflow and AWS:</p><table><thead><tr><th align="left">Service</th><th align="left">Local</th><th align="left">AWS</th></tr></thead><tbody><tr><td align="left"><strong>Datastore</strong></td><td align="left">Local Directory</td><td align="left"><a href="https://aws.amazon.com/s3/" target="_blank" rel="noopener noreferrer">Amazon S3</a></td></tr><tr><td align="left"><strong>Compute</strong></td><td align="left">Local Process</td><td align="left"><a href="https://aws.amazon.com/batch/" target="_blank" rel="noopener noreferrer">AWS Batch</a></td></tr><tr><td align="left"><strong>Metadata</strong></td><td align="left">Local Directory</td><td align="left"><a href="https://aws.amazon.com/fargate/" target="_blank" rel="noopener noreferrer">AWS Fargate</a> + <a href="https://aws.amazon.com/rds" target="_blank" rel="noopener noreferrer">Amazon RDS</a></td></tr><tr><td align="left"><strong>Notebooks</strong></td><td align="left">Local Notebook</td><td align="left"><a href="https://aws.amazon.com/sagemaker/" target="_blank" rel="noopener noreferrer">Amazon Sagemaker Notebooks</a></td></tr><tr><td align="left"><strong>Scheduling</strong></td><td align="left">-</td><td align="left"><a href="https://aws.amazon.com/step-functions/" target="_blank" rel="noopener noreferrer">AWS Step Functions</a> + <a href="https://aws.amazon.com/eventbridge/" target="_blank" rel="noopener noreferrer">Amazon EventBridge</a></td></tr><tr><td align="left"><strong>Large-scale ML</strong></td><td align="left">-</td><td align="left"><a href="https://aws.amazon.com/sagemaker/" target="_blank" rel="noopener noreferrer">Sagemaker Models</a>*</td></tr><tr><td align="left"><strong>Hosting</strong></td><td align="left">-</td><td align="left">*</td></tr></tbody></table><p>(<!-- -->*<!-- -->)<!-- --> <a href="/v/r/introduction/roadmap">available later</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="datastore"><strong>Datastore</strong><a class="hash-link" href="#datastore" title="Direct link to heading">​</a></h3><p>Datastore is a centralized data repository for all the data that&#x27;s leveraged by and
generated by Metaflow flows. In the local mode, all data artifacts are stored in a local
directory. Metaflow integrates with Amazon S3 for cloud-scale storage so that you can
process and persist larger amounts of data easily.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="compute">Compute<a class="hash-link" href="#compute" title="Direct link to heading">​</a></h3><p>Metaflow executes all steps in the flow as a separate local process in local mode. To
run larger workloads which require resources that might not be available on a laptop
<!-- -->(<!-- -->think GPUs or 100s of GBs of RAM<!-- -->)<!-- -->, Metaflow integrates with AWS Batch to seamlessly
run every step of the flow as a <!-- -->(<!-- -->or many<!-- -->)<!-- --> separate AWS Batch job<!-- -->(<!-- -->s<!-- -->)<!-- -->.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="metadata">Metadata<a class="hash-link" href="#metadata" title="Direct link to heading">​</a></h3><p>Metaflow ships with a light-weight <a href="https://github.com/Netflix/metaflow-service" target="_blank" rel="noopener noreferrer">metaflow
service</a> that provides a centralized place
to keep track of all flow executions. This metadata service is not strictly needed.
Metaflow will use a local directory to keep track of all executions from your laptop,
even if you are using Amazon S3 as datastore or AWS Batch for
<a href="/v/r/metaflow-on-aws#compute">compute</a>. You can use a local Jupyter notebook to interact
with data artifacts from all your previous executions as well as currently running ones.
However, deploying the metaflow service <!-- -->(<!-- -->as well as Amazon S3 as datastore<!-- -->)<!-- --> is helpful
if you would like to share results with your peers and track your work without fear of
losing any state.</p><p>At Netflix, all executions are logged in the metaflow service and all data artifacts are
stored in Amazon S3, so that any data scientist can interface with anybody&#x27;s work via
the <a href="/v/r/metaflow/client">client</a> and collaborate fruitfully. Also, a centralized
metaflow service along with a data store like Amazon S3 makes it easy for data
scientists at Netflix to use hosted notebooks to easily set-up dashboards to monitors
their flows.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="notebooks">Notebooks<a class="hash-link" href="#notebooks" title="Direct link to heading">​</a></h3><p>We are a <a href="https://netflixtechblog.com/notebook-innovation-591ee3221233" target="_blank" rel="noopener noreferrer">big fan of
Notebooks</a> at Netflix.
With Metaflow, users can easily create custom dashboards to monitor the execution of
their Metaflow flows and track how their models are behaving in a very seamless manner.
They can do that on their laptops with a local notebook or in the cloud with a hosted
notebook solution. One such hosted solution is <a href="https://aws.amazon.com/sagemaker/" target="_blank" rel="noopener noreferrer">Sagemaker
Notebooks</a> by AWS. For notebooks hosted in the cloud,
you would want to ensure that you have configured the <a href="/v/r/metaflow-on-aws#metadata">metaflow
service</a> and are using Amazon S3 for
<a href="/v/r/metaflow-on-aws#datastore">datastore</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="scheduling">Scheduling<a class="hash-link" href="#scheduling" title="Direct link to heading">​</a></h3><p>With Metaflow, users can create, prototype and execute flows from their laptops that can
scale easily by leveraging elastic storage and compute capabilities in the cloud. Often,
there comes a time, when these flows need to be run autonomously without any user
intervention. At that point, Metaflow makes it easy to move the flow execution from
Metaflow to AWS Step Functions to leverage all the feature sets that you get from a
production grade scheduler - high availability, monitoring, reliability, etc. In
addition, with AWS EventBridge, users can set triggers to execute these flows on a
schedule automatically.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using-metaflow-with-aws">Using Metaflow with AWS<a class="hash-link" href="#using-metaflow-with-aws" title="Direct link to heading">​</a></h2><p>When you install Metaflow for the first time, you start in the local mode. Artifacts and
metadata are stored in a local directory and computation is performed with local
processes. This mode is perfectly fine for personal use but if your use case involves
more people and/or data, we recommend that you configure Metaflow to use AWS.</p><p>Even after Metaflow has been configured to use AWS, users can still choose to use local
tools, e.g. for rapid prototyping. The easy back-and-forth between local and remote is a
key value proposition of Metaflow. However, we recommend that you enable <strong>metadata</strong>
and <strong>datastore</strong> to use AWS by default, which makes sure that all data stays persistent
and everyone in the organization can benefit from the results of workflows.</p><p>Netflix uses this setup internally. To make the experience smoother, Netflix&#x27;s data
scientists are provided with a <!-- -->(<!-- -->shared<!-- -->)<!-- --> EC2 instance where they can develop and test
Metaflow code with minimal latency between their development environment and S3. Note
that many IDEs such as <a href="https://code.visualstudio.com/" target="_blank" rel="noopener noreferrer">VSCode</a> or
<a href="https://rstudio.com/" target="_blank" rel="noopener noreferrer">RStudio</a> support execution on a remote instance natively.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="next-steps">Next Steps<a class="hash-link" href="#next-steps" title="Direct link to heading">​</a></h2><p>If your organization doesn&#x27;t have an AWS account already, we provide a hosted sandbox
environment where you can test Metaflow using your own code and data, to get a feel of
the benefits of AWS. Read more in the section about <a href="https://metaflow.org/sandbox" target="_blank" rel="noopener noreferrer">Metaflow
Sandbox</a>.</p><p>If your organization has an AWS account already, see our <a href="https://outerbounds.com/docs/admin/metaflow-on-aws/deployment-guide" target="_blank" rel="noopener noreferrer">deployment
guide</a> for detailed
instructions on how to configure your account for Metaflow.</p><p>If you are already using Metaflow in your AWS account, and want to get started with how
to manage various AWS resources, take a look at our <a href="https://outerbounds.com/docs/admin/metaflow-on-aws/operations-guide" target="_blank" rel="noopener noreferrer">operations
guide</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.dev/Netflix/metaflow-docs/blob/master/docs/v/r/metaflow-on-aws/metaflow-on-aws.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#amazon-web-services" class="table-of-contents__link toc-highlight">Amazon Web Services</a><ul><li><a href="#datastore" class="table-of-contents__link toc-highlight"><strong>Datastore</strong></a></li><li><a href="#compute" class="table-of-contents__link toc-highlight">Compute</a></li><li><a href="#metadata" class="table-of-contents__link toc-highlight">Metadata</a></li><li><a href="#notebooks" class="table-of-contents__link toc-highlight">Notebooks</a></li><li><a href="#scheduling" class="table-of-contents__link toc-highlight">Scheduling</a></li></ul></li><li><a href="#using-metaflow-with-aws" class="table-of-contents__link toc-highlight">Using Metaflow with AWS</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.81c8b9a4.js"></script>
<script src="/assets/js/main.93f3962d.js"></script>
</body>
</html>